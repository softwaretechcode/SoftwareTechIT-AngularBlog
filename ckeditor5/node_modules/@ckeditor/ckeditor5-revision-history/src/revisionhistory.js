/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x50ea=['end','isAnonymous','update','restrictedEditingException','save','selection','numeric','remove','init','saveRevision','_restoreRevision','RevisionHistory','style','getAttributeKeys','createdAt','from','RevisionsRepository','users','_cleanUp','set','change','data','repository','uiLanguage','fromVersion','requires','destroy','revisionHistory.closeRevisionViewerCallback','isEnabled','creator','revision-history-viewer-opened','detachRoot','display','locale','_recalculatePageBreaks','setAttribute','isAttached','Restored','removeMarker','_closeRevisionViewer','RevisionHistoryUI','_getRevisionViewerEditorConfig','$graveyard','enqueueChange','revision-history-missing-configuration','RevisionTracker','removeSelectionAttribute','getUser','then','get','model','_enhanceCloseRevisionViewerCallback','editor','getRoot','exitToEditing','rootName','getRevisionRootsAttributes','_viewerEditor','commands','insert','parse','revisionHistory.restoreRevisionCallback','addUser','addRoot','enableReadOnlyMode','document','toVersion','pluginName','RevisionViewer','long','isReady','Annotations','revisionHistory.viewerContainer','addRevisionData','Users','define','revisionHistory','PaginationLookup','toolbar','refreshVisibility','restoreRevision','plugins','error','config','result','revisionHistory.showRevisionViewerCallback','none','includes','showRevisionViewerCallback','_update','getRevisions','roots','create','removeAttribute','adapter','has','changesNavigation','getRevision','catch','disableReadOnlyMode','bind','Autosave','toJSON','_enhanceShowRevisionViewerCallback','closeRevisionViewerCallback','name','setSelection','indexOf'];(function(_0x9657ca,_0x50ea96){const _0x395752=function(_0x39c2d1){while(--_0x39c2d1){_0x9657ca['push'](_0x9657ca['shift']());}};_0x395752(++_0x50ea96);}(_0x50ea,0x8b));const _0x3957=function(_0x9657ca,_0x50ea96){_0x9657ca=_0x9657ca-0x0;let _0x395752=_0x50ea[_0x9657ca];return _0x395752;};import{Plugin as _0x3b8f38}from'ckeditor5/src/core';import{CKEditorError as _0x2b6802,uid as _0x31a2a3}from'ckeditor5/src/utils';import _0xbb3356 from'./revisiontracker';import _0x3a971c from'./ui/revisionhistory/revisionhistoryui';import _0x229bb8 from'./revisionviewer';import _0xc0259c from'./ui/revisionviewer/revisionviewerui';import _0x178952 from'./ui/revisionssidebar/revisionssidebar';import _0x256fcd from'./editor/revisionviewereditor';import{getTranslation as _0x40b5c9}from'./utils/common-translations';import{sanitizeEditorConfig as _0x39d69c}from'ckeditor5-collaboration/src/collaboration-core';const g=[_0x3957('0x9'),'RestrictedEditingMode'];class k extends _0x3b8f38{static get[_0x3957('0x24')](){return'RevisionViewerIntegration';}constructor(_0x12971b){super(_0x12971b),this[_0x3957('0x35')]=_0x3957('0x4d');}}export default class b extends _0x3b8f38{static get[_0x3957('0x24')](){return _0x3957('0x58');}static get[_0x3957('0x66')](){return[_0xbb3356,_0x3a971c];}constructor(_0x10224d){if(super(_0x10224d),!this[_0x3957('0x15')][_0x3957('0x34')][_0x3957('0x12')](_0x3957('0x2d')))throw new _0x2b6802(_0x3957('0xd'),this);this[_0x3957('0x1a')]=null,this[_0x3957('0x15')]['config'][_0x3957('0x2c')]('revisionHistory.showRevisionViewerCallback',_0x2092cb=>this['_showRevisionViewer'](_0x2092cb)),this[_0x3957('0x15')]['config']['define'](_0x3957('0x68'),_0x4a41d8=>this[_0x3957('0x8')](_0x4a41d8)),this[_0x3957('0x15')]['config'][_0x3957('0x2c')](_0x3957('0x1e'),_0x7c1276=>this['_restoreRevision'](_0x7c1276)),this[_0x3957('0x48')](),this['_enhanceCloseRevisionViewerCallback']();}set['adapter'](_0x43fce2){this['editor']['plugins'][_0x3957('0x12')](_0x3957('0xe'))[_0x3957('0x3f')]=_0x43fce2;}get['adapter'](){return this[_0x3957('0x15')]['plugins'][_0x3957('0x12')]('RevisionTracker')[_0x3957('0x3f')];}[_0x3957('0x2a')](_0x225dc1){return this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x12')]('RevisionTracker')[_0x3957('0x2a')](_0x225dc1);}[_0x3957('0x42')](_0x363b00){return this['editor'][_0x3957('0x32')]['get'](_0x3957('0x5d'))['getRevision'](_0x363b00);}['getRevisions'](_0x2bc733={'toJSON':!0x1}){return this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x12')](_0x3957('0x5d'))[_0x3957('0x3b')](_0x2bc733);}['_getRevisionViewerEditorConfig'](){const _0x44da2d=this[_0x3957('0x15')],_0x19c0c7=_0x39d69c(_0x44da2d,g),_0x222098=_0x44da2d[_0x3957('0x32')][_0x3957('0x12')]('RevisionTracker'),_0x237f7e=_0x44da2d[_0x3957('0x32')]['get'](_0x3957('0x2b'))[_0x3957('0x5e')];return _0x19c0c7[_0x3957('0x2f')]=[_0x3957('0x17'),_0x3957('0x31'),_0x3957('0x41')],delete _0x19c0c7['lazyRoots'],(_0x19c0c7[_0x3957('0x32')]['push'](k,_0x229bb8,_0xc0259c,class extends _0x3b8f38{static get[_0x3957('0x66')](){return[_0x229bb8,_0x3957('0x2b')];}[_0x3957('0x55')](){const _0x24a863=this[_0x3957('0x15')]['plugins'][_0x3957('0x12')]('Users');for(const _0x2a2861 of _0x237f7e)_0x2a2861[_0x3957('0x4e')]||_0x24a863[_0x3957('0x10')](_0x2a2861['id'])||_0x24a863[_0x3957('0x1f')](_0x2a2861);const _0x4c3fe8=_0x222098[_0x3957('0x63')][_0x3957('0x3b')]();let _0x434bb7=null;const _0x20eef8=this['editor'][_0x3957('0x32')][_0x3957('0x12')]('RevisionViewer');_0x20eef8[_0x3957('0x3f')]=_0x222098['adapter'],_0x20eef8[_0x3957('0x45')](_0x3957('0x69'))['to'](_0x222098),this[_0x3957('0x15')][_0x3957('0x1b')][_0x3957('0x12')](_0x3957('0x31'))[_0x3957('0x45')](_0x3957('0x69'))['to'](_0x44da2d,'isReadOnly',_0x2a7ba2=>!_0x2a7ba2);for(const _0x193b10 of _0x4c3fe8){const _0x22c5ba=null===_0x193b10[_0x3957('0x6a')];if(_0x22c5ba&&_0x193b10[_0x3957('0x23')]===_0x193b10[_0x3957('0x65')])continue;const _0x2fdb54=_0x193b10['toJSON']();_0x20eef8[_0x3957('0x2a')](_0x2fdb54,(_0x504c86,_0x2aff45,_0x4d108f)=>{if(_0x22c5ba){if(_0x434bb7)_0x434bb7['_update'](_0x504c86,_0x2aff45);else{if(!_0x2aff45){const _0x5b92e2=_0x4d108f[_0x3957('0x47')]();_0x5b92e2['id']=_0x31a2a3(),_0x222098['saveRevision'](_0x5b92e2,_0x4d108f[_0x3957('0x23')])[_0x3957('0x11')](_0x1f9769=>{_0x434bb7=_0x1f9769;});}}}else _0x193b10[_0x3957('0x3a')](_0x504c86,_0x2aff45);});}}},_0x178952),_0x19c0c7);}[_0x3957('0x48')](){const _0x504088=this[_0x3957('0x15')]['config']['get'](_0x3957('0x2d'))[_0x3957('0x39')];this[_0x3957('0x15')][_0x3957('0x34')][_0x3957('0x60')](_0x3957('0x36'),async()=>{this[_0x3957('0x15')][_0x3957('0x21')](_0x3957('0x6b'));const _0x7105af=this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x12')](_0x3957('0xe'));if(this[_0x3957('0x15')][_0x3957('0x32')]['has'](_0x3957('0x46'))){const _0x59a0b8=this['editor'][_0x3957('0x32')][_0x3957('0x12')](_0x3957('0x46'));await _0x59a0b8[_0x3957('0x51')]();}else await _0x7105af[_0x3957('0x4f')]();this[_0x3957('0x15')][_0x3957('0x32')]['has'](_0x3957('0x2e'))&&this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x12')](_0x3957('0x2e'))[_0x3957('0x3')]();const _0xebf2=this[_0x3957('0xa')]();return _0x504088(_0xebf2)[_0x3957('0x11')](_0x3a85dd=>{return(this[_0x3957('0x1a')]=_0x3a85dd,this[_0x3957('0x15')][_0x3957('0x32')]['has'](_0x3957('0x28')))&&this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x12')](_0x3957('0x28'))[_0x3957('0x30')](),_0x3a85dd;})[_0x3957('0x43')](_0xbf8624=>(console[_0x3957('0x33')](_0xbf8624),this['editor'][_0x3957('0x44')](_0x3957('0x6b')),null));});}[_0x3957('0x14')](){const _0x2977fa=this[_0x3957('0x15')][_0x3957('0x34')][_0x3957('0x12')](_0x3957('0x2d'))[_0x3957('0x49')];this[_0x3957('0x15')]['config']['set']('revisionHistory.closeRevisionViewerCallback',()=>(this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x40')](_0x3957('0x2e'))&&this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x12')](_0x3957('0x2e'))['_recalculatePageBreaks'](),this['_viewerEditor'][_0x3957('0x32')]['get'](_0x3957('0x25'))[_0x3957('0x5f')](),_0x2977fa(this[_0x3957('0x1a')])[_0x3957('0x11')](()=>{if(this[_0x3957('0x15')]['disableReadOnlyMode'](_0x3957('0x6b')),this[_0x3957('0x1a')]=null,this[_0x3957('0x15')][_0x3957('0x32')][_0x3957('0x40')](_0x3957('0x28'))){const _0x219caa=this['editor']['plugins']['get'](_0x3957('0x28'));_0x219caa[_0x3957('0x30')](),_0x219caa['refreshPositioning']();}})));}['_showRevisionViewer'](_0x55cbe2){const _0x31248a=this[_0x3957('0x15')][_0x3957('0x34')]['get']('revisionHistory.editorContainer'),_0x5d33e0=this['editor'][_0x3957('0x34')]['get'](_0x3957('0x29')),_0x3c271b=this[_0x3957('0x15')]['config']['get']('revisionHistory.viewerEditorElement');return _0x256fcd[_0x3957('0x3d')](_0x3c271b,_0x55cbe2)[_0x3957('0x11')](_0x3f0f1c=>(_0x5d33e0[_0x3957('0x59')]['display']='block',_0x31248a[_0x3957('0x59')]['display']=_0x3957('0x37'),_0x3f0f1c));}[_0x3957('0x8')](_0x56b1d6){const _0x1108e8=this[_0x3957('0x15')][_0x3957('0x34')][_0x3957('0x12')]('revisionHistory.editorContainer');return this[_0x3957('0x15')][_0x3957('0x34')][_0x3957('0x12')]('revisionHistory.viewerContainer')[_0x3957('0x59')]['display']=_0x3957('0x37'),_0x1108e8[_0x3957('0x59')][_0x3957('0x1')]='',_0x56b1d6[_0x3957('0x67')]();}async[_0x3957('0x57')](_0xf9837){const _0x2dbc6d=this[_0x3957('0x15')],_0x147e71=this[_0x3957('0x1a')]['plugins'][_0x3957('0x12')]('RevisionViewer'),_0x219c6d=_0x2dbc6d[_0x3957('0x32')][_0x3957('0x12')]('RevisionTracker'),_0x3490ed=_0x147e71[_0x3957('0x63')][_0x3957('0x42')](_0xf9837);let _0x1d2eae,_0x26be5e,_0x26daa7;try{_0x1d2eae=await _0x147e71['getRevisionData'](_0x3490ed),_0x26be5e=await _0x147e71[_0x3957('0x19')](_0x3490ed);}catch(_0x39dc3f){return void console[_0x3957('0x33')](_0x39dc3f);}_0x2dbc6d['model'][_0x3957('0x61')](_0x4f751b=>{for(const _0xf85668 of Array[_0x3957('0x5c')](_0x2dbc6d['model']['markers']['getMarkersGroup'](_0x3957('0x50'))))_0x4f751b[_0x3957('0x7')](_0xf85668);}),_0x147e71[_0x3957('0x27')]=!0x1,_0x2dbc6d[_0x3957('0x13')][_0x3957('0xc')](_0x279a3a=>{_0x279a3a[_0x3957('0x4b')](null),_0x279a3a[_0x3957('0xf')](_0x2dbc6d[_0x3957('0x13')][_0x3957('0x22')][_0x3957('0x52')][_0x3957('0x5a')]());const _0x574665=Object['keys'](_0x1d2eae);for(const _0x342eae of _0x2dbc6d['model'][_0x3957('0x22')][_0x3957('0x3c')])_0x3957('0xb')!=_0x342eae[_0x3957('0x18')]&&_0x342eae['isAttached']()&&!_0x574665[_0x3957('0x38')](_0x342eae[_0x3957('0x18')])&&_0x279a3a[_0x3957('0x0')](_0x342eae);for(const _0x50e1fd of _0x574665){let _0x48c18d=_0x2dbc6d[_0x3957('0x13')]['document'][_0x3957('0x16')](_0x50e1fd);_0x48c18d&&_0x48c18d[_0x3957('0x5')]()||(_0x48c18d=_0x279a3a[_0x3957('0x20')](_0x50e1fd));const _0x3695dc=_0x26be5e[_0x50e1fd],_0x67b967=Object['keys'](_0x3695dc),_0x26bb6b=_0x1d2eae[_0x50e1fd];for(const _0x5b0fbe of _0x48c18d['getAttributeKeys']())_0x67b967[_0x3957('0x38')](_0x5b0fbe)||_0x279a3a[_0x3957('0x3e')](_0x5b0fbe,_0x48c18d);for(const _0xf611bd of _0x67b967)_0x279a3a[_0x3957('0x4')](_0xf611bd,_0x26be5e[_0x50e1fd][_0xf611bd],_0x48c18d);_0x279a3a[_0x3957('0x54')](_0x279a3a['createRangeIn'](_0x48c18d)),_0x279a3a[_0x3957('0x1c')](_0x2dbc6d[_0x3957('0x62')][_0x3957('0x1d')](_0x26bb6b,_0x48c18d),_0x48c18d,0x0);}});const _0xe9a33e=_0x40b5c9(_0x2dbc6d['locale'],_0x3957('0x6'));if(_0x3490ed['name'])_0x26daa7=-0x1==_0x3490ed[_0x3957('0x4a')][_0x3957('0x4c')](_0xe9a33e)?_0xe9a33e+':\x20'+_0x3490ed[_0x3957('0x4a')]:_0x3490ed[_0x3957('0x4a')];else _0x26daa7=_0xe9a33e+':\x20'+(_0x3490ed['createdAt']['toLocaleDateString'](_0x2dbc6d['locale'][_0x3957('0x64')],{'month':_0x3957('0x26'),'day':_0x3957('0x53')})+',\x20'+_0x3490ed[_0x3957('0x5b')]['toLocaleTimeString'](_0x2dbc6d[_0x3957('0x2')]['uiLanguage'],{'hour':_0x3957('0x53'),'minute':_0x3957('0x53')}));return await _0x219c6d[_0x3957('0x56')]({'name':_0x26daa7}),_0x147e71['isReady']=!0x0,_0x2dbc6d[_0x3957('0x34')][_0x3957('0x12')](_0x3957('0x2d'))[_0x3957('0x49')]();}}