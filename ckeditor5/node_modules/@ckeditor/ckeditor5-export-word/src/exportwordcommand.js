/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x4e3cec}from'ckeditor5/src/core';import{getStyles as _0x1b8c33,getConverterOptions as _0x2467d1}from'./utils';export default class i extends _0x4e3cec{constructor(_0x2f0f8f){super(_0x2f0f8f),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x51eff2={}){const _0x29b81d=this['editor'],t=_0x29b81d['t'],_0x286ec3=_0x51eff2['converterUrl']||'https://docx-converter.cke-cs.com/v1/convert',_0x4fc401=_0x51eff2['converterOptions']||{},_0x1a4f6e=_0x29b81d['plugins']['get']('ExportWord'),_0x126001=_0x51eff2['token']||_0x1a4f6e['_token'],_0xd450e5=!0x1!==_0x4fc401['auto_pagination'],_0xa2af10=_0x51eff2['dataCallback']||(_0x105385=>_0x105385['data']['get']({'pagination':_0xd450e5}));return this['isBusy']=!0x0,this['refresh'](),_0x1b8c33(_0x51eff2['stylesheets']||['EDITOR_STYLES'])['then'](async _0x398051=>{const _0x71fadb=await _0xa2af10(_0x29b81d),_0x389199={'html':'<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x29b81d['locale']['contentLanguageDirection']+'\x22>'+_0x71fadb+'</div>','css':_0x398051,'options':{..._0x4fc401,..._0x2467d1(_0x29b81d)}},_0x14e0b1={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/docx',..._0x126001?{'Authorization':_0x126001['value']}:null},'body':JSON['stringify'](_0x389199)};return window['fetch'](_0x286ec3,_0x14e0b1)['then'](_0x24b713=>{if(0xc8!==_0x24b713['status'])throw _0x24b713;return _0x24b713['blob']();})['then'](_0x2997db=>{const _0x56897b='function'==typeof _0x51eff2['fileName']?_0x51eff2['fileName']():_0x51eff2['fileName'];this['_downloadFile'](_0x2997db,_0x56897b||'document.docx');});})['catch'](_0x1acc8c=>{throw _0x29b81d['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20Word\x20file.')),_0x1acc8c;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x3c0500,_0x2288c9){const _0x3adc2f=document['createElement']('a');_0x3adc2f['href']=window['URL']['createObjectURL'](_0x3c0500),_0x3adc2f['download']=_0x2288c9,_0x3adc2f['click'](),_0x3adc2f['remove']();}}