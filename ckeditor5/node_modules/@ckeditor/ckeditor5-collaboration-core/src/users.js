/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2425=['avatar','users-add-invalid-id','locale','_addAnonymousUser','context','_getInitial','destroy','trial-license-key-reached-limit-time','users-me-already-defined','getBackgroundColorClass','pluginName','initials','licenseKeyTrialLimit:time','licenseKeyTrialLimit:operations','Anonymous','getMarkerClass','init','users.colorsCount','_locale','length','ck-user__selection--','get','_isAnonymous','ck-user__marker--','_id','users-me-missing-user','includes','getUser','trial-license-key-reached-limit-changes','requires','_lastColor','getSelectionClass','decorate','users','getOperationAuthor','users-add-duplicated-id','licenseKey','anonymous-user','color','licenseKeyInvalid','licenseKeyValid','useAnonymousUser','string','config','toUpperCase','addUser','_licenseKeyCheckInterval','_getNextColor','licenseKeyTrialLimit:revisions','licenseKeyTrial','define','defineMe','info','name','_myId','users.anonymousUserId','invalid-license-key'];(function(_0x3ac4c9,_0x2425a0){const _0x29e3cf=function(_0x248c71){while(--_0x248c71){_0x3ac4c9['push'](_0x3ac4c9['shift']());}};_0x29e3cf(++_0x2425a0);}(_0x2425,0x15b));const _0x29e3=function(_0x3ac4c9,_0x2425a0){_0x3ac4c9=_0x3ac4c9-0x0;let _0x29e3cf=_0x2425[_0x3ac4c9];return _0x29e3cf;};import{ContextPlugin as _0x32f3a8}from'ckeditor5/src/core';import{Collection as _0x53eff0,CKEditorError as _0x29f1d9}from'ckeditor5/src/utils';import _0x2e45f8 from'./permissions';import{getTranslation as _0x2d9ece}from'./utils/common-translations';import'../theme/usercolors.css';export default class l extends _0x32f3a8{static get[_0x29e3('0x5')](){return'Users';}static get[_0x29e3('0x18')](){return[_0x2e45f8];}constructor(_0x8048c){super(_0x8048c),this[_0x29e3('0x38')]['config'][_0x29e3('0x2d')]('users.anonymousUserId',_0x29e3('0x20')),this[_0x29e3('0x38')][_0x29e3('0x26')][_0x29e3('0x2d')](_0x29e3('0xc'),0x8),this['users']=new _0x53eff0(),this[_0x29e3('0xd')]=_0x8048c[_0x29e3('0x36')],this['_licenseKeyCheckInterval']=null,this[_0x29e3('0x19')]=0x0,this[_0x29e3('0x31')]=null,this[_0x29e3('0x1b')]('getOperationAuthor');}[_0x29e3('0xb')](){const _0xb510fe=this[_0x29e3('0x38')];this['licenseKey']=_0xb510fe[_0x29e3('0x26')][_0x29e3('0x10')](_0x29e3('0x1f'));const _0xc32d73=[_0x29e3('0x2c'),'licenseKeyInvalid',_0x29e3('0x23'),'licenseKeyTrialLimit:operations',_0x29e3('0x7'),_0x29e3('0x2b')];this['_licenseKeyCheckInterval']=setInterval(()=>{let _0x4567ee;for(const _0xe91fdc in _0xb510fe){const _0x13a194=_0xb510fe[_0xe91fdc];if(_0xc32d73[_0x29e3('0x15')](_0x13a194)){delete _0xb510fe[_0xe91fdc],_0x4567ee=_0x13a194;break;}}if(_0x29e3('0x22')===_0x4567ee)throw clearInterval(this[_0x29e3('0x29')]),new _0x29f1d9(_0x29e3('0x33'),null);if(_0x29e3('0x2c')===_0x4567ee&&console[_0x29e3('0x2f')]('You\x20are\x20using\x20the\x20trial\x20version\x20of\x20CKEditor\x205\x20collaboration\x20plugin\x20with\x20limited\x20usage.\x20Make\x20sure\x20you\x20will\x20not\x20use\x20it\x20in\x20the\x20production\x20environment.'),_0x29e3('0x8')===_0x4567ee)throw clearInterval(this[_0x29e3('0x29')]),new _0x29f1d9(_0x29e3('0x17'),null);if(_0x29e3('0x7')===_0x4567ee)throw clearInterval(this[_0x29e3('0x29')]),new _0x29f1d9(_0x29e3('0x2'),null);if('licenseKeyTrialLimit:revisions'===_0x4567ee)throw clearInterval(this[_0x29e3('0x29')]),new _0x29f1d9('trial-license-key-reached-limit-revisions',null);'licenseKeyValid'===_0x4567ee&&clearInterval(this[_0x29e3('0x29')]);},0x3e8),this[_0x29e3('0x37')]();}get['me'](){return null==this[_0x29e3('0x31')]?null:this[_0x29e3('0x16')](this[_0x29e3('0x31')]);}['addUser']({id:_0x1cc5a9,name:_0xa3a947,..._0x64606f}){if(!_0x1cc5a9||_0x29e3('0x25')!=typeof _0x1cc5a9)throw new _0x29f1d9(_0x29e3('0x35'));if(this[_0x29e3('0x1c')]['has'](_0x1cc5a9))throw new _0x29f1d9(_0x29e3('0x1e'),null,{'id':_0x1cc5a9});const _0x2f1c19={..._0x64606f,'id':_0x1cc5a9,'name':a(this['_locale'],_0xa3a947),'color':this[_0x29e3('0x2a')]()};_0x2f1c19['name']=a(this[_0x29e3('0xd')],_0x2f1c19['name']);const _0x5826f6=new User(_0x2f1c19);return this[_0x29e3('0x1c')]['add'](_0x5826f6),_0x5826f6;}[_0x29e3('0x16')](_0x19502e){return this['users']['get'](_0x19502e);}[_0x29e3('0x24')](){const _0x147f3b=this['context'][_0x29e3('0x26')][_0x29e3('0x10')](_0x29e3('0x32'));this[_0x29e3('0x31')]||this[_0x29e3('0x2e')](_0x147f3b);}[_0x29e3('0x2e')](_0x506cee){if(this['_myId'])throw new _0x29f1d9(_0x29e3('0x3'),null);if(!this[_0x29e3('0x16')](_0x506cee))throw new _0x29f1d9(_0x29e3('0x14'),null);this[_0x29e3('0x31')]=_0x506cee;}[_0x29e3('0x1d')](){return this['me'];}['destroy'](){super[_0x29e3('0x1')](),clearInterval(this[_0x29e3('0x29')]);}[_0x29e3('0x2a')](){const _0x3ebc48=this[_0x29e3('0x38')][_0x29e3('0x26')][_0x29e3('0x10')](_0x29e3('0xc'));return this['_lastColor']>=_0x3ebc48&&(this[_0x29e3('0x19')]=0x0),new u(this[_0x29e3('0x19')]++);}[_0x29e3('0x37')](){const _0x21ce4e=this[_0x29e3('0x38')][_0x29e3('0x26')][_0x29e3('0x10')]('users.anonymousUserId');this[_0x29e3('0x28')]({'id':_0x21ce4e,'name':_0x2d9ece(this[_0x29e3('0xd')],_0x29e3('0x9'))})[_0x29e3('0x11')]=!0x0;}}export class User{constructor(_0x44eddb){this['id']=_0x44eddb['id'],this[_0x29e3('0x21')]=_0x44eddb[_0x29e3('0x21')],this[_0x29e3('0x30')]=_0x44eddb[_0x29e3('0x30')],this[_0x29e3('0x34')]=_0x44eddb['avatar'],this[_0x29e3('0x11')]=!0x1;}get['isAnonymous'](){return this[_0x29e3('0x11')];}get[_0x29e3('0x6')](){const _0x5c5fad=this['name']['split']('\x20');return 0x1===_0x5c5fad[_0x29e3('0xe')]?this[_0x29e3('0x0')](_0x5c5fad[0x0]):this[_0x29e3('0x0')](_0x5c5fad[0x0])+this[_0x29e3('0x0')](_0x5c5fad[_0x5c5fad[_0x29e3('0xe')]-0x1]);}[_0x29e3('0x0')](_0x27dbdc){return _0x27dbdc['charAt'](0x0)[_0x29e3('0x27')]();}}function a(_0x18e201,_0x4d9121=''){return''==(_0x4d9121=_0x4d9121['trim']())?_0x2d9ece(_0x18e201,_0x29e3('0x9')):_0x4d9121;}class u{constructor(_0x2df19a){this['_id']=_0x2df19a;}[_0x29e3('0x4')](){return'ck-user__bg-color--'+this[_0x29e3('0x13')];}[_0x29e3('0x1a')](){return _0x29e3('0xf')+this[_0x29e3('0x13')];}[_0x29e3('0xa')](){return _0x29e3('0x12')+this['_id'];}}