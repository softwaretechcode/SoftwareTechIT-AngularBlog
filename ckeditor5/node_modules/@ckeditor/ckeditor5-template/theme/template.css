/*
 * Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */

@import "@ckeditor/ckeditor5-ui/theme/mixins/_dir.css";
@import "@ckeditor/ckeditor5-ui/theme/mixins/_rwd.css";

:root {
	--ck-template-dropdown-view-width: 345px;
	--ck-template-dropdown-view-height: 300px;
	--ck-template-list-height: 245px;
	--ck-template-icon-size: 45px;
	--ck-template-search-field-horizontal-spacing: calc(var(--ck-icon-size) + var(--ck-spacing-medium));
}

.ck.ck-template-form {
	width: var(--ck-template-dropdown-view-width);

	@mixin ck-media-phone {
		--ck-template-dropdown-view-width: 260px;
	}

	& > .ck-template-form__info {
		width: 100%;
		padding: calc(2 * var(--ck-spacing-large)) var(--ck-spacing-large);
		text-align: center;

		& * {
			white-space: normal;
			text-align: center;
		}

		& > span:first-child {
			display: block;
			font-weight: bold;
		}

		& > span:last-child {
			margin-top: var(--ck-spacing-medium);
		}

		/* Hide the entire list when nothing was found */
		&:not(.ck-hidden) ~ .ck-list {
			display: none;
		}
	}

	& > .ck.ck-list.ck-template-list {
		max-height: var(--ck-template-dropdown-view-height);
		padding: var(--ck-spacing-large);
		overflow-x: hidden;
		overflow-y: auto;
		overscroll-behavior: contain;

		/*
		 * This is a dirty way to increase the selector specificity and override the default rounded corners
		 * of a list inside a dropdown panel
		 */
		@nest .ck-rounded-corners & {
			border-radius: 0;
		}

		& > .ck.ck-list__item {
			/* This is an easy way to address the problem of spacings between hidden and visible list items */
			&:not(.ck-hidden) ~ .ck.ck-list__item {
				margin-top: var(--ck-spacing-large);
			}

			& > .ck.ck-button {
				width: 100%;
				margin: 0;
				padding: 0;
				border-radius: var(--ck-border-radius);

				/* Crop the icon when the border-radius is large */
				overflow: hidden;

				display: grid;
				grid-template-columns: var(--ck-template-icon-size) 1fr;
				grid-template-rows: var(--ck-template-icon-size);
				grid-auto-columns: 1fr;

				gap: var(--ck-spacing-large) var(--ck-spacing-large);
				grid-auto-flow: column dense;
				align-items: center;
				grid-template-areas: "ck-template-icon ck-template-content";

				&:not(:focus) {
					border-color: var(--ck-color-dropdown-panel-background);
				}

				& > .ck.ck-icon {
					width: var(--ck-template-icon-size);
					height: auto;
					grid-area: ck-template-icon;
					margin: 0;

					/* Override default rules for icons to allow any fill color. */
					color: unset;

					& * {
						color: unset;

						&:not([fill]) {
							fill: unset;
						}
					}
				}

				& > .ck-template-form__text-part {
					display: flex;
					flex-direction: column;
					justify-content: space-evenly;
					height: 100%;
					grid-area: ck-template-content;
					min-width: 0;
					margin: 0;

					& > .ck.ck-button__label {
						display: block;
						font-weight: bold;
						font-size: var(--ck-font-size-base);
						color: var(--ck-color-text);
						line-height: 1.1;

						white-space: nowrap;
						overflow: hidden;
						text-overflow: ellipsis;
					}

					& .ck-template-form__description {
						display: -webkit-box;
						font-size: 0.85em;
						color: var(--ck-color-text);
						line-height: 1.1;

						/* Leave some tiny spacing between title and description. */
						margin-top: var(--ck-spacing-tiny);

						white-space: normal;
						overflow: hidden;
						text-overflow: ellipsis;
						-webkit-box-orient: vertical;
						-webkit-line-clamp: 2;
					}

					& mark {
						background: var(--ck-color-highlight-background);
						vertical-align: initial;
						font-weight: inherit;
						line-height: inherit;
						font-size: inherit;
					}
				}
			}
		}
	}

	& > .ck-labeled-field-view {
		--ck-labeled-field-label-default-position-x: var(--ck-template-search-field-horizontal-spacing);
		--ck-labeled-field-empty-unfocused-max-width: 100% - 2 * var(--ck-template-search-field-horizontal-spacing);

		padding: var(--ck-spacing-large);

		&.ck-labeled-field-view_empty {
			--ck-labeled-field-empty-unfocused-max-width: 100% - var(--ck-template-search-field-horizontal-spacing) - var(--ck-spacing-medium);
		}

		& > .ck-labeled-field-view__input-wrapper > .ck-icon {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			opacity: .5;
			pointer-events: none;

			@mixin ck-dir ltr {
				left: var(--ck-spacing-medium);
			}

			@mixin ck-dir rtl {
				right: var(--ck-spacing-medium);
			}
		}

		& .ck-input {
			width: 100%;

			@mixin ck-dir ltr {
				padding-left: var(--ck-template-search-field-horizontal-spacing);

				&:not(.ck-input-text_empty) {
					padding-right: var(--ck-template-search-field-horizontal-spacing);
				}
			}

			@mixin ck-dir rtl {
				padding-right: var(--ck-template-search-field-horizontal-spacing);

				&:not(.ck-input-text_empty) {
					padding-left: var(--ck-template-search-field-horizontal-spacing);
				}
			}
		}

		& .ck-template-form__clear-search {
			position: absolute;
			top: 50%;
			transform: translateY(-50%);
			min-width: auto;
			min-height: auto;

			background: none;
			opacity: .5;
			padding: 0;

			@mixin ck-dir ltr {
				right: var(--ck-spacing-medium);
			}

			@mixin ck-dir rtl {
				left: var(--ck-spacing-medium);
			}

			&:hover {
				opacity: 1;
			}
		}
	}

	& > .ck-template-form__info:not(:only-child),
	& > .ck.ck-list {
		border-top: 1px solid var(--ck-color-base-border);
	}
}
