/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
import{Command as _0x3ae896}from'ckeditor5/src/core';import{getStyles as _0x5b8ef1}from'./utils';export default class i extends _0x3ae896{constructor(_0x171caf){super(_0x171caf),this['set']('isBusy',!0x1),this['affectsData']=!0x1;}['refresh'](){this['isEnabled']=!this['isBusy'],this['value']=this['isBusy']?'pending':void 0x0;}['execute'](_0x3b7732={}){const _0x3c9853=this['editor'],t=_0x3c9853['t'],_0x58e7b9=_0x3b7732['converterUrl']||'https://pdf-converter.cke-cs.com/v1/convert/',_0x166b48=_0x3b7732['dataCallback']||(_0xb67f4=>_0xb67f4['data']['get']()),_0x21c883=_0x3c9853['plugins']['get']('ExportPdf'),_0x1a1f1b=_0x3b7732['token']||_0x21c883['_token'];return this['isBusy']=!0x0,this['refresh'](),_0x5b8ef1(_0x3b7732['stylesheets']||['EDITOR_STYLES'])['then'](async _0x1c9b7e=>{const _0x5373ac={'html':'<html>\x0a\x09\x09\x09\x09\x09\x09<head>\x0a\x09\x09\x09\x09\x09\x09\x09<title>CKEditor\x205\x20PDF\x20document</title>\x0a\x09\x09\x09\x09\x09\x09\x09<meta\x20charset=\x22utf-8\x22>\x0a\x09\x09\x09\x09\x09\x09</head>\x0a\x09\x09\x09\x09\x09\x09<body>\x0a\x09\x09\x09\x09\x09\x09\x09<div\x20class=\x22ck-content\x22\x20dir=\x22'+_0x3c9853['locale']['contentLanguageDirection']+'\x22>\x0a\x09\x09\x09\x09\x09\x09\x09\x09'+await _0x166b48(_0x3c9853)+'\x0a\x09\x09\x09\x09\x09\x09\x09</div>\x0a\x09\x09\x09\x09\x09\x09</body>\x0a\x09\x09\x09\x09\x09</html>','css':_0x1c9b7e,'options':_0x3b7732['converterOptions']},_0x3d58d0={'method':'POST','headers':{'Content-Type':'application/json','Accept':'application/pdf',..._0x1a1f1b?{'Authorization':_0x1a1f1b['value']}:null,'x-cs-app-id':_0x3b7732['appID']||'cke5'},'body':JSON['stringify'](_0x5373ac)};return window['fetch'](_0x58e7b9,_0x3d58d0)['then'](_0x3b55ef=>{if(0xc8!==_0x3b55ef['status'])throw _0x3b55ef;return _0x3b55ef['blob']();})['then'](_0x4586d1=>{const _0x394e6c='function'==typeof _0x3b7732['fileName']?_0x3b7732['fileName']():_0x3b7732['fileName'];this['_downloadFile'](_0x4586d1,_0x394e6c||'document.pdf');});})['catch'](_0x1046a1=>{throw _0x3c9853['plugins']['get']('Notification')['showWarning'](t('An\x20error\x20occurred\x20while\x20generating\x20the\x20PDF.')),_0x1046a1;})['finally'](()=>{this['isBusy']=!0x1,this['refresh']();});}['_downloadFile'](_0x5d5b4d,_0x122f07){const _0xd7609e=document['createElement']('a');_0xd7609e['href']=window['URL']['createObjectURL'](_0x5d5b4d),_0xd7609e['download']=_0x122f07,_0xd7609e['click'](),_0xd7609e['remove']();}}