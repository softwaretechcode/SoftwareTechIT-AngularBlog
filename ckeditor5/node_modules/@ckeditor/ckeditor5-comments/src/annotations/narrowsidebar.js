/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x44aa=['set:container','mousedown','remove','element','pluginName','keyCode','register','uiUpdate','northArrowSouth','_selectedAnnotations','keydown','_detachListeners','isAttached','has','focus','balloonPanelView','context','attachToDom','create','_attachListeners','annotations','resize','removeEventListener','_domEmitter','listenTo','low','ck-sidebar--narrow','refresh','values','_refreshPositioningDebounced','get','_refreshPositioning','stopListening','includes','find','clear','getByView','destroy','_showBalloon','southArrowNorth','_setSelectedAnnotations','blur','contains','delete','add','hasDomSelection','execute','getOrderedSelectedAnnotations','content','southArrowNorthWest','rearrange','esc','editors','EditorAnnotations','isDirty','_hideBalloon','detach','plugins','preventClosingBalloon','addEventListener','getSidebarItemView','requires','_annotationToNarrowView','isVisible','pin','_annotations','high','view','_editorAnnotations','activeAnnotation','_integrateWithEditorAnnotations','from','_destroyEditorAnnotationsIntegration','attach','cancel','_attachToContainer','Esc','length','_manuallyClosedAnnotationViews','type','addAnnotation','_updateBalloonPosition','focusableElements','first','bodyCollection','stopPropagation','narrowSidebar','set','defaultPositions','target','setActiveAnnotation'];(function(_0x42790c,_0x44aa37){const _0x48998b=function(_0x153ad7){while(--_0x153ad7){_0x42790c['push'](_0x42790c['shift']());}};_0x48998b(++_0x44aa37);}(_0x44aa,0x17b));const _0x4899=function(_0x42790c,_0x44aa37){_0x42790c=_0x42790c-0x0;let _0x48998b=_0x44aa[_0x42790c];return _0x48998b;};import{ContextPlugin as _0x21606a,Context as _0x5d04b1}from'ckeditor5/src/core';import _0x1c5bad from'./annotationsuis';import _0x1c84a2 from'./sidebar';import _0xd25026 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x39ced8,BodyCollection as _0x569cb6}from'ckeditor5/src/ui';import{CKEditorError as _0x4bb7b8,DomEmitterMixin as _0x404662,keyCodes as _0x297d0d,Collection as _0x14b5f8}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{debounce as _0x4b3394}from'lodash-es';import _0x2aa2f4 from'./editorannotations';export default class s extends _0x21606a{static get[_0x4899('0x2e')](){return[_0x1c84a2,_0x1c5bad];}static get[_0x4899('0x50')](){return'NarrowSidebar';}constructor(_0xeb7cd4){super(_0xeb7cd4),this['isAttached']=!0x1,this[_0x4899('0x3f')]=new Set(),this['_domEmitter']=Object[_0x4899('0x3')](_0x404662),this[_0x4899('0x2f')]=new Map(),this[_0x4899('0x48')](_0x4899('0x36'),null),this['annotations']=null,this['_selectedAnnotations']=[],this['_editorAnnotations']=new _0x14b5f8(),this[_0x4899('0xe')]=_0x4b3394(()=>{this[_0x4899('0x10')]();},0xfa,{'leading':!0x1});}['init'](){this[_0x4899('0x1')][_0x4899('0x2a')][_0x4899('0xf')](_0x1c5bad)[_0x4899('0x52')](_0x4899('0x47'),this),this[_0x4899('0x45')]=new _0x569cb6(this[_0x4899('0x1')]['locale']),this['balloonPanelView']=new _0x39ced8(this[_0x4899('0x1')]['locale']),this[_0x4899('0x45')][_0x4899('0x2')](),this[_0x4899('0x45')][_0x4899('0x1d')](this[_0x4899('0x0')]);}[_0x4899('0x3a')](_0x1959aa){this[_0x4899('0x5')]=_0x1959aa;const _0x27e765=this[_0x4899('0x1')][_0x4899('0x2a')]['get'](_0x1c84a2),_0x46a492=this[_0x4899('0x0')];if(_0x27e765[_0x4899('0x32')]=_0x1959aa,this['isAttached'])throw new _0x4bb7b8('narrowsidebar-attach-already-attached',this);this['isAttached']=!0x0,this[_0x4899('0x9')](_0x27e765,_0x4899('0x4c'),()=>{this[_0x4899('0x29')](),this['listenTo'](_0x27e765,'change:container',_0x4a6f12=>{_0x4a6f12['off'](),this[_0x4899('0x3a')](_0x1959aa);});}),_0x27e765[_0x4899('0x3c')]({'viewClass':_0x4899('0xb'),'spaceBetweenItems':0x5});const _0x24f6e7=_0x45b814=>{const _0x4037c9=new _0xd25026(this[_0x4899('0x1')]['locale']);_0x27e765[_0x4899('0x41')](_0x45b814,_0x4037c9),this['_annotationToNarrowView']['set'](_0x45b814,_0x4037c9),_0x4037c9['bind'](_0x4899('0x27'),'annotationType','number')['to'](_0x45b814['view'],_0x4899('0x27'),_0x4899('0x40'),_0x4899('0x3e')),_0x4037c9['on'](_0x4899('0x1f'),()=>{this[_0x4899('0x3f')][_0x4899('0x14')](),_0x46a492['content'][_0x4899('0x44')]!==_0x45b814[_0x4899('0x34')]?(this[_0x4899('0x17')](_0x45b814),_0x45b814[_0x4899('0x34')][_0x4899('0x4f')][_0x4899('0x5a')](),this[_0x4899('0x4b')](_0x45b814)):this[_0x4899('0x4b')](null);});};for(const _0x5a50e8 of _0x1959aa)_0x24f6e7(_0x5a50e8);this[_0x4899('0x9')](_0x1959aa,_0x4899('0x1d'),(_0x191a30,_0xdeeaf8)=>{_0x24f6e7(_0xdeeaf8);}),this[_0x4899('0x9')](_0x1959aa,'remove',(_0x44fe64,_0x5ffe0c,_0x562239)=>{this[_0x4899('0x2f')][_0x4899('0xf')](_0x5ffe0c)[_0x4899('0x16')](),this[_0x4899('0x2f')][_0x4899('0x1c')](_0x5ffe0c),_0x27e765[_0x4899('0x23')]({'removedAnnotation':_0x5ffe0c,'previousAnnotation':_0x1959aa['get'](_0x562239-0x1),'nextAnnotation':_0x1959aa[_0x4899('0xf')](_0x562239+0x1)}),_0x5ffe0c===this[_0x4899('0x36')]&&this[_0x4899('0x4b')](null);},{'priority':_0x4899('0xa')}),this[_0x4899('0x9')](_0x1959aa,'focus',(_0xbd8e31,_0x77239f)=>{this[_0x4899('0x4b')](_0x77239f);}),this[_0x4899('0x9')](_0x1959aa,_0x4899('0x1a'),()=>{this['setActiveAnnotation'](null);}),this['_domEmitter'][_0x4899('0x9')](document,_0x4899('0x56'),(_0x1ce23a,_0x17c15d)=>{_0x17c15d[_0x4899('0x51')]===_0x297d0d[_0x4899('0x24')]&&_0x46a492[_0x4899('0x30')]&&(this[_0x4899('0x3f')][_0x4899('0x1d')](_0x46a492['content'][_0x4899('0x44')]),this[_0x4899('0x28')](),_0x17c15d[_0x4899('0x46')](),_0x17c15d['preventDefault']());}),this[_0x4899('0x8')][_0x4899('0x9')](document,_0x4899('0x4d'),(_0x1e3666,_0x10707d)=>{const _0x49e8e1=_0x10707d[_0x4899('0x4a')];_0x46a492[_0x4899('0x30')]&&_0x46a492[_0x4899('0x4f')][_0x4899('0x1b')](_0x49e8e1)||_0x27e765[_0x4899('0x34')]['element'][_0x4899('0x1b')](_0x49e8e1)||_0x1e3666[_0x4899('0x2b')]||this['activeAnnotation']&&this[_0x4899('0x36')][_0x4899('0x43')][_0x4899('0x13')](_0x8a9f24=>_0x8a9f24[_0x4899('0x1b')](_0x49e8e1))||(this[_0x4899('0x3f')]['clear'](),this[_0x4899('0x28')](),this[_0x4899('0x4b')](null));});const _0x2a7acb=this[_0x4899('0x1')]instanceof _0x5d04b1?this[_0x4899('0x1')][_0x4899('0x25')]:new _0x14b5f8([this[_0x4899('0x1')]]);for(const _0x266fae of _0x2a7acb)this[_0x4899('0x37')](_0x266fae);this['listenTo'](_0x2a7acb,_0x4899('0x1d'),(_0x4e88a5,_0x33a62f)=>{this[_0x4899('0x9')](_0x33a62f,'ready',()=>{this['_integrateWithEditorAnnotations'](_0x33a62f);});}),this['listenTo'](_0x2a7acb,_0x4899('0x4e'),(_0x3e310a,_0x43b36d)=>{_0x43b36d[_0x4899('0x2a')][_0x4899('0x59')](_0x4899('0x26'))&&this[_0x4899('0x39')](_0x43b36d[_0x4899('0x2a')][_0x4899('0xf')](_0x4899('0x26')));}),window[_0x4899('0x2c')](_0x4899('0x6'),this[_0x4899('0xe')]),this[_0x4899('0x10')]();}[_0x4899('0x4b')](_0x49dffb){if(_0x49dffb===this[_0x4899('0x36')])return;const _0x28e567=this[_0x4899('0x1')]['plugins']['get'](_0x1c84a2);if(_0x28e567[_0x4899('0xc')]({'blurredAnnotation':this[_0x4899('0x36')],'activatedAnnotation':_0x49dffb,'disableAnimationOnActivatedAnnotation':!0x0}),_0x49dffb)_0x28e567[_0x4899('0x2d')](_0x49dffb)?this[_0x4899('0x17')](_0x49dffb):this[_0x4899('0x28')]();else this['_hideBalloon']();this[_0x4899('0x36')]=_0x49dffb;}[_0x4899('0x29')](){if(!this[_0x4899('0x58')])throw new _0x4bb7b8('narrowsidebar-detach-not-attached',this);this[_0x4899('0x4b')](null);const _0x55c40b=this[_0x4899('0x1')][_0x4899('0x2a')][_0x4899('0xf')](_0x1c84a2);this[_0x4899('0x28')](),Array[_0x4899('0x38')](this[_0x4899('0x2f')][_0x4899('0xd')](),_0x551521=>_0x551521['destroy']()),this[_0x4899('0x2f')][_0x4899('0x14')](),_0x55c40b['_detachFromContainer'](this[_0x4899('0x5')]),this[_0x4899('0x11')](),this[_0x4899('0x8')][_0x4899('0x11')](),this[_0x4899('0x1')]instanceof _0x5d04b1&&this[_0x4899('0x11')](this[_0x4899('0x1')][_0x4899('0x25')]);for(const _0x299702 of Array[_0x4899('0x38')](this[_0x4899('0x35')]))this[_0x4899('0x39')](_0x299702);window[_0x4899('0x7')](_0x4899('0x6'),this[_0x4899('0xe')]),this[_0x4899('0xe')][_0x4899('0x3b')](),this[_0x4899('0x55')]=[],this[_0x4899('0x58')]=!0x1,this[_0x4899('0x5')]=null;}['destroy'](){this[_0x4899('0x58')]&&this[_0x4899('0x29')](),this[_0x4899('0x45')]['detachFromDom']();}[_0x4899('0x37')](_0x2ce05f){const _0x3a8538=_0x2ce05f[_0x4899('0x2a')][_0x4899('0xf')](_0x2aa2f4),_0x224358=this['context'][_0x4899('0x2a')][_0x4899('0xf')](_0x1c84a2),_0x1b46b9=this[_0x4899('0x5')],_0x29e9b4=this['balloonPanelView'],_0x25b8f1=()=>{const _0x344086=_0x3a8538[_0x4899('0x20')]({'annotations':this['annotations'],'activeAnnotation':this[_0x4899('0x36')]});this['_setSelectedAnnotations'](_0x344086),this[_0x4899('0x4b')](_0x344086[0x0]||null);};this['listenTo'](_0x3a8538,_0x4899('0xc'),_0x25b8f1),this[_0x4899('0x9')](_0x3a8538,'blur',(_0x58e6df,{isAnnotationTracked:_0x3ff0d8})=>{this[_0x4899('0x36')]&&_0x3ff0d8(this[_0x4899('0x36')])&&(this[_0x4899('0x19')]([]),this['setActiveAnnotation'](null));}),this[_0x4899('0x9')](_0x3a8538,_0x4899('0x53'),()=>{this[_0x4899('0xe')]();}),this[_0x4899('0x9')](_0x1b46b9,_0x4899('0x1a'),_0x4728a1=>{_0x3a8538[_0x4899('0x1e')]()&&_0x4728a1['stop']();},{'priority':_0x4899('0x33')}),this[_0x4899('0x9')](this['_domEmitter'],_0x4899('0x4d'),(_0x38a3e5,_0xabed04)=>{const _0x3aa528=_0xabed04[_0x4899('0x4a')];_0x29e9b4['isVisible']&&_0x29e9b4[_0x4899('0x4f')][_0x4899('0x1b')](_0x3aa528)||_0x224358['view'][_0x4899('0x4f')][_0x4899('0x1b')](_0x3aa528)||this[_0x4899('0x36')]&&_0x3a8538[_0x4899('0x1e')]()&&(_0x25b8f1(),_0x38a3e5[_0x4899('0x2b')]=!0x0);},{'priority':_0x4899('0x33')}),this[_0x4899('0x35')][_0x4899('0x1d')](_0x3a8538);}[_0x4899('0x39')](_0x22e7cc){_0x22e7cc&&(this[_0x4899('0x11')](_0x22e7cc),this['_editorAnnotations']['remove'](_0x22e7cc));}[_0x4899('0x19')](_0x525d8d){for(const _0x3b1fa8 of this[_0x4899('0x55')])_0x525d8d[_0x4899('0x12')](_0x3b1fa8)||this['_manuallyClosedAnnotationViews'][_0x4899('0x1c')](_0x3b1fa8[_0x4899('0x34')]);this[_0x4899('0x55')]=_0x525d8d;}['_refreshPositioning'](){const _0x2ee624=this['balloonPanelView'];this[_0x4899('0x5')]['refreshPositioning'](),_0x2ee624['isVisible']&&this[_0x4899('0x42')]();}[_0x4899('0x17')](_0x30ecad){if(this[_0x4899('0x3f')][_0x4899('0x59')](_0x30ecad[_0x4899('0x34')]))return;const _0x546c1b=this[_0x4899('0x0')][_0x4899('0x21')][_0x4899('0x44')];_0x546c1b!==_0x30ecad[_0x4899('0x34')]?(_0x546c1b&&this[_0x4899('0x57')](_0x546c1b),this[_0x4899('0x4')](_0x30ecad[_0x4899('0x34')]),this[_0x4899('0x0')][_0x4899('0x21')][_0x4899('0x14')](),this['balloonPanelView'][_0x4899('0x21')]['add'](_0x30ecad['view']),this[_0x4899('0x42')]()):this['_updateBalloonPosition']();}[_0x4899('0x42')](){const _0x585dd3=this[_0x4899('0x0')]['content'][_0x4899('0x44')],_0x5d628a=_0x585dd3&&this[_0x4899('0x5')][_0x4899('0x15')](_0x585dd3);if(!_0x5d628a||!this[_0x4899('0x2f')][_0x4899('0x59')](_0x5d628a))return;const _0x135eb7=this[_0x4899('0x2f')][_0x4899('0xf')](_0x5d628a)[_0x4899('0x4f')],_0x1ba0a7=function(){const _0xd359ab=_0x39ced8[_0x4899('0x49')];return[_0xd359ab['southArrowNorthEast'],_0xd359ab['northArrowSouthEast'],_0xd359ab[_0x4899('0x18')],_0xd359ab[_0x4899('0x54')],_0xd359ab[_0x4899('0x22')],_0xd359ab['northArrowSouthWest']];}();this['balloonPanelView'][_0x4899('0x31')]({'target':_0x135eb7,'positions':_0x1ba0a7});}['_hideBalloon'](){const _0x124343=this[_0x4899('0x0')],_0x17e501=_0x124343[_0x4899('0x21')][_0x4899('0x44')];_0x17e501&&(this[_0x4899('0x57')](_0x17e501),_0x124343['unpin'](),_0x124343[_0x4899('0x21')]['clear']());}['_attachListeners'](_0x2aaa68){this[_0x4899('0x9')](_0x2aaa68,'change:height',()=>this[_0x4899('0x42')]()),this[_0x4899('0x9')](_0x2aaa68,_0x4899('0x3d'),(_0x10869a,_0x1a507b)=>{this[_0x4899('0x3f')][_0x4899('0x1d')](_0x2aaa68),this[_0x4899('0x28')](),_0x1a507b();});}[_0x4899('0x57')](_0x141ab0){this['stopListening'](_0x141ab0);}}