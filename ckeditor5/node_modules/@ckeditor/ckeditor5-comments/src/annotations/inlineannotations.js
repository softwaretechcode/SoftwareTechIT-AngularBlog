/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x56f9=['requires','top','collapse','isFocused','set','attach','refresh','remove','_selectedAnnotations','InlineAnnotations','afterInit','plugins','destroy','left','blur','change:visibleView','showStack','getBoundingClientRect','_addedAnnotations','hasView','focusTracker','hasActive','Esc','width','setActiveAnnotation','selection','activeAnnotation','listenTo','map','bottom','register','_balloon','view','isAttached','getFirstRange','inline','_removeAnnotationFromBalloon','editing','length','add','getByView','_closeAnnotation','includes','every','init','change:height','_setSelectedAnnotations','addObserver','_addAnnotationToBalloon','document','delete','fromRect','_forceRefresh','domConverter','annotations','update','stopListening','targetRect','inlineannotations-not-allowed-with-context','right','focus','getClientRects','editor','isActive','find','get','keystrokes','visibleView','detach','_manuallyClosed','context','has','pluginName','push','_getBalloonTargetForAnnotation','getOrderedSelectedAnnotations','updatePosition'];(function(_0x8fb7bb,_0x56f9a5){const _0x29af8a=function(_0x1aba22){while(--_0x1aba22){_0x8fb7bb['push'](_0x8fb7bb['shift']());}};_0x29af8a(++_0x56f9a5);}(_0x56f9,0x89));const _0x29af=function(_0x8fb7bb,_0x56f9a5){_0x8fb7bb=_0x8fb7bb-0x0;let _0x29af8a=_0x56f9[_0x8fb7bb];return _0x29af8a;};import{Plugin as _0x4e4fb3}from'ckeditor5/src/core';import _0xa0360a from'./annotationsuis';import _0xac1013 from'./editorannotations';import{ContextualBalloon as _0x187e5f}from'ckeditor5/src/ui';import{MouseObserver as _0x482d2d}from'ckeditor5/src/engine';import{CKEditorError as _0x5aceb7,Rect as _0x2f9ec5}from'ckeditor5/src/utils';import'./../../theme/annotation-inline.css';export default class c extends _0x4e4fb3{static get[_0x29af('0x11')](){return[_0xac1013,_0x187e5f,_0xa0360a];}static get[_0x29af('0xc')](){return _0x29af('0x1a');}constructor(_0x1611d6){super(_0x1611d6),_0x1611d6[_0x29af('0x36')][_0x29af('0x31')][_0x29af('0x40')](_0x482d2d),this['isAttached']=!0x1,this[_0x29af('0x15')](_0x29af('0x2b'),null),this[_0x29af('0x47')]=null,this[_0x29af('0x9')]=new Set(),this['_balloon']=_0x1611d6['plugins'][_0x29af('0x5')](_0x187e5f),this['_addedAnnotations']=new Set(),this['_selectedAnnotations']=[],this[_0x29af('0x45')]=!0x1;}[_0x29af('0x3d')](){const _0x5977d1=this[_0x29af('0x2')][_0x29af('0x1c')][_0x29af('0x5')](_0xa0360a);_0x5977d1[_0x29af('0xa')]===this[_0x29af('0x2')]&&(_0x5977d1[_0x29af('0x2f')]('inline',this),this[_0x29af('0x2')][_0x29af('0x6')][_0x29af('0x15')]('Esc',(_0x4f5068,_0x45550e)=>{const _0x32e8e9=this[_0x29af('0x30')];if(this[_0x29af('0x32')]&&_0x32e8e9['visibleView']){const _0x4e815e=this[_0x29af('0x47')][_0x29af('0x39')](_0x32e8e9['visibleView']);_0x4e815e&&this[_0x29af('0x3a')](_0x4e815e),_0x45550e();}}));}[_0x29af('0x1b')](){const _0x2cbf1f=this[_0x29af('0x2')][_0x29af('0x1c')][_0x29af('0x5')](_0xa0360a);_0x2cbf1f['context']===this[_0x29af('0x2')]&&(_0x2cbf1f[_0x29af('0x26')]()||_0x2cbf1f['switchTo'](_0x29af('0x34')));}[_0x29af('0x29')](_0x1abbaf){_0x1abbaf!==this[_0x29af('0x2b')]&&(this[_0x29af('0x2b')]&&(this[_0x29af('0x2b')][_0x29af('0x3')]=!0x1),_0x1abbaf&&this[_0x29af('0x2')]['ui'][_0x29af('0x25')][_0x29af('0x14')]&&(this[_0x29af('0x47')][_0x29af('0xb')](_0x1abbaf)&&this[_0x29af('0x41')](_0x1abbaf,!0x0),_0x1abbaf['isActive']=!0x0),_0x1abbaf||this[_0x29af('0x3f')]([]),this['activeAnnotation']=_0x1abbaf);}[_0x29af('0x16')](_0x3caa34){this['annotations']=_0x3caa34;const _0x5639c6=this['editor'][_0x29af('0x1c')][_0x29af('0x5')](_0xa0360a),_0x4bfff0=this[_0x29af('0x30')];if(this['isAttached'])throw new _0x5aceb7('inlineannotations-attach-already-attached',this);if(_0x5639c6[_0x29af('0xa')]!==this[_0x29af('0x2')])throw new _0x5aceb7(_0x29af('0x4b'),this);const _0x5ef627=this[_0x29af('0x2')][_0x29af('0x1c')][_0x29af('0x5')](_0xac1013);this[_0x29af('0x2c')](_0x5ef627,_0x29af('0x17'),()=>{const _0x12abbe=_0x5ef627[_0x29af('0xf')]({'annotations':this[_0x29af('0x47')],'activeAnnotation':this[_0x29af('0x2b')]});var _0x6b9807,_0x8bccd7;!this[_0x29af('0x45')]&&(_0x6b9807=_0x12abbe,_0x8bccd7=this['_selectedAnnotations'],_0x6b9807[_0x29af('0x37')]===_0x8bccd7[_0x29af('0x37')]&&_0x6b9807[_0x29af('0x3c')](_0x4662e5=>_0x8bccd7[_0x29af('0x3b')](_0x4662e5)))||(this['_forceRefresh']=!0x1,this[_0x29af('0x3f')](_0x12abbe),this[_0x29af('0x29')](_0x12abbe[0x0]||null));}),this[_0x29af('0x2c')](_0x5ef627,_0x29af('0x1f'),(_0x5d7824,{isAnnotationTracked:_0x4f53aa})=>{this[_0x29af('0x2b')]&&_0x4f53aa(this[_0x29af('0x2b')])&&(this[_0x29af('0x3f')]([]),this[_0x29af('0x29')](null));}),this[_0x29af('0x2c')](this[_0x29af('0x2')]['ui'][_0x29af('0x25')],'change:isFocused',(_0x336656,_0xd63b83,_0x57a091)=>{_0x57a091||this['setActiveAnnotation'](null);}),this[_0x29af('0x2c')](_0x3caa34,'remove',(_0x25e725,_0x8a22a)=>{this[_0x29af('0x35')](_0x8a22a),_0x8a22a===this[_0x29af('0x2b')]&&this[_0x29af('0x29')](null);}),this[_0x29af('0x2c')](_0x4bfff0,_0x29af('0x20'),(_0x43d651,_0x27678a,_0x151789,_0x5ce006)=>{_0x5ce006&&this['stopListening'](_0x5ce006);const _0x3cf1a3=_0x3caa34[_0x29af('0x39')](_0x151789);_0x151789&&_0x3cf1a3&&(this[_0x29af('0x2c')](_0x151789,_0x29af('0x3e'),()=>{_0x4bfff0[_0x29af('0x10')]();}),this['listenTo'](_0x151789,_0x29af('0x27'),()=>{this['_closeAnnotation'](_0x3cf1a3),this[_0x29af('0x2')][_0x29af('0x36')]['view'][_0x29af('0x0')]();}),this[_0x29af('0x2b')]!==_0x3cf1a3&&this[_0x29af('0x29')](_0x3cf1a3));}),this[_0x29af('0x2c')](this[_0x29af('0x2')]['ui'],_0x29af('0x48'),()=>{_0x4bfff0['visibleView']&&(_0x3caa34[_0x29af('0x39')](_0x4bfff0[_0x29af('0x7')])&&_0x4bfff0[_0x29af('0x10')]());}),this[_0x29af('0x2c')](this[_0x29af('0x2')][_0x29af('0x36')][_0x29af('0x31')]['document'],'mousedown',()=>{this[_0x29af('0x45')]=!0x0,this[_0x29af('0x9')]['clear']();}),this[_0x29af('0x2')]['editing'][_0x29af('0x31')][_0x29af('0x42')][_0x29af('0x2a')]['editableElement']&&this[_0x29af('0x2')][_0x29af('0x36')][_0x29af('0x31')][_0x29af('0x0')](),this['isAttached']=!0x0;}[_0x29af('0x8')](){if(!this[_0x29af('0x32')])throw new _0x5aceb7('inlineannotations-detach-not-attached',this);this[_0x29af('0x29')](null);for(const _0x589aa6 of this[_0x29af('0x23')])this['_removeAnnotationFromBalloon'](_0x589aa6);this[_0x29af('0x49')](),this[_0x29af('0x32')]=!0x1,this[_0x29af('0x47')]=null;}[_0x29af('0x1d')](){this['isAttached']&&this[_0x29af('0x8')]();}[_0x29af('0x3f')](_0x41acac){for(const _0x2c5b3d of this[_0x29af('0x19')])_0x41acac[_0x29af('0x3b')](_0x2c5b3d)||this['_manuallyClosed']['delete'](_0x2c5b3d);for(const _0x519f07 of this[_0x29af('0x47')])_0x41acac[_0x29af('0x3b')](_0x519f07)||this[_0x29af('0x35')](_0x519f07);if(this[_0x29af('0x2')]['ui'][_0x29af('0x25')][_0x29af('0x14')])for(const _0x517ef6 of _0x41acac)this[_0x29af('0x41')](_0x517ef6);this[_0x29af('0x19')]=_0x41acac;}[_0x29af('0x41')](_0x46f350,_0x57391c=!0x1){this[_0x29af('0x9')][_0x29af('0xb')](_0x46f350)||(this['_addedAnnotations'][_0x29af('0xb')](_0x46f350)||this[_0x29af('0x30')][_0x29af('0x24')](_0x46f350[_0x29af('0x31')])||(this[_0x29af('0x23')][_0x29af('0x38')](_0x46f350),this[_0x29af('0x30')][_0x29af('0x38')]({'stackId':_0x46f350[_0x29af('0x31')]['id'],'view':_0x46f350['view'],'position':{'target':()=>this['_getBalloonTargetForAnnotation'](_0x46f350)}})),_0x57391c&&this['_balloon'][_0x29af('0x21')](_0x46f350[_0x29af('0x31')]['id']));}[_0x29af('0xe')](_0x1ff727){const _0x57fcb2=_0x1ff727['target'],_0x344e61=this[_0x29af('0x2')]['editing'][_0x29af('0x31')],_0x4d14a0=_0x344e61[_0x29af('0x42')][_0x29af('0x2a')][_0x29af('0x33')](),_0x3a9570=_0x344e61[_0x29af('0x46')]['viewRangeToDom'](_0x4d14a0);if(_0x3a9570[_0x29af('0x13')](!0x0),_0x57fcb2){if(_0x57fcb2 instanceof _0x2f9ec5)return _0x57fcb2;let _0x144ca5=[];for(const _0x5e4863 of _0x57fcb2)_0x144ca5[_0x29af('0xd')](...(_0x2d5d8d=_0x5e4863[_0x29af('0x1')](),Array['from'](_0x2d5d8d)[_0x29af('0x2d')](DOMRect[_0x29af('0x44')])));_0x144ca5=function(_0x4aba1b){const _0x42fa25=[];let _0x42d96b=_0x4aba1b[0x0];for(let _0x47eabb=0x1;_0x47eabb<_0x4aba1b['length'];_0x47eabb++)F(_0x42d96b,_0x4aba1b[_0x47eabb])?_0x42d96b['width']+=_0x4aba1b[_0x47eabb][_0x29af('0x28')]:(_0x42fa25['push'](_0x42d96b),_0x42d96b=_0x4aba1b[_0x47eabb]);return _0x42fa25[_0x29af('0xd')](_0x42d96b),_0x42fa25;}(_0x144ca5);const _0x108215=_0x3a9570[_0x29af('0x22')]();return _0x144ca5[_0x29af('0x4')](_0x1996a3=>_0x1996a3[_0x29af('0x12')]<=_0x108215[_0x29af('0x12')]&&_0x1996a3['bottom']>=_0x108215[_0x29af('0x2e')]&&_0x1996a3[_0x29af('0x1e')]<=_0x108215[_0x29af('0x1e')]&&_0x1996a3['right']>=_0x108215[_0x29af('0x4c')])||_0x144ca5[0x0];}var _0x2d5d8d;return _0x1ff727[_0x29af('0x4a')]||_0x3a9570;}['_removeAnnotationFromBalloon'](_0x13ce21){this['_addedAnnotations'][_0x29af('0xb')](_0x13ce21)&&this[_0x29af('0x30')][_0x29af('0x24')](_0x13ce21[_0x29af('0x31')])&&(this[_0x29af('0x23')][_0x29af('0x43')](_0x13ce21),this['_balloon'][_0x29af('0x18')](_0x13ce21[_0x29af('0x31')]));}[_0x29af('0x3a')](_0x5dc2cd){this[_0x29af('0x9')][_0x29af('0x38')](_0x5dc2cd),this[_0x29af('0x35')](_0x5dc2cd);}}function F(_0x3fef60,_0x29e14a){return _0x3fef60['top']===_0x29e14a[_0x29af('0x12')]&&_0x3fef60['bottom']===_0x29e14a[_0x29af('0x2e')]&&_0x3fef60[_0x29af('0x4c')]===_0x29e14a['left'];}