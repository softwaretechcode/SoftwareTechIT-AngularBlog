/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2f6b=['change:activeAnnotation','remove','init','_visibleAnnotations','delete','AnnotationsUIs','_activateAnnotation','type','activeUIs','_assertAnnotationDoesNotBelongToMultipleUIs','_setSelectedAnnotations','activate','stopListening','function','_deactivateAllAnnotations','push','refilterAnnotations','collection','hasActive','find','context','attach','listenTo','isActive','get','length','deactivateAll','deactivate','add','register','from','_uis','activeAnnotations','detach','plugins','setActiveAnnotation','set','has','_removeActiveAnnotation','annotationsuis-missing-ui','annotationsuis-register-already-registered','size','pluginName','_uisData','destroy'];(function(_0x3f1a36,_0x2f6b49){const _0x222e3c=function(_0x31c5c5){while(--_0x31c5c5){_0x3f1a36['push'](_0x3f1a36['shift']());}};_0x222e3c(++_0x2f6b49);}(_0x2f6b,0x16d));const _0x222e=function(_0x3f1a36,_0x2f6b49){_0x3f1a36=_0x3f1a36-0x0;let _0x222e3c=_0x2f6b[_0x3f1a36];return _0x222e3c;};import{ContextPlugin as _0x86448f}from'ckeditor5/src/core';import{CKEditorError as _0x519c9e}from'ckeditor5/src/utils';import _0x45efe3,{bindAnnotationCollections as _0x242ca8}from'./annotationcollection';import _0x5c75f1 from'./annotations';export default class M extends _0x86448f{static get['requires'](){return[_0x5c75f1];}static get[_0x222e('0x25')](){return _0x222e('0x0');}constructor(_0x2f73b5){super(_0x2f73b5),this[_0x222e('0x3')]=new Set(),this[_0x222e('0x1a')]=new Map(),this[_0x222e('0x26')]=new Map();}[_0x222e('0x2a')](){const _0x2e4d1e=this[_0x222e('0xf')][_0x222e('0x1d')][_0x222e('0x13')](_0x5c75f1);this[_0x222e('0x11')](_0x2e4d1e,_0x222e('0x1'),(_0x1fc851,_0x59715a)=>{for(const _0x3f305b of this[_0x222e('0x3')]){const _0x190799=this[_0x222e('0x1a')][_0x222e('0x13')](_0x3f305b);(0x0,this[_0x222e('0x26')][_0x222e('0x13')](_0x3f305b)['filter'])(_0x59715a)&&_0x190799[_0x222e('0x1e')](_0x59715a);}}),this[_0x222e('0x11')](_0x2e4d1e,_0x222e('0x9'),()=>{for(const _0x20f974 of this[_0x222e('0x3')]){this[_0x222e('0x1a')][_0x222e('0x13')](_0x20f974)[_0x222e('0x1e')](null);}}),this[_0x222e('0x11')](_0x2e4d1e['_visibleAnnotations'],_0x222e('0x17'),(_0x44faa0,_0x8dd248)=>{this[_0x222e('0x4')](_0x8dd248);});}[_0x222e('0xd')](){return this[_0x222e('0x3')][_0x222e('0x24')]>0x0;}[_0x222e('0x12')](_0x55785f){return this[_0x222e('0x3')]['has'](_0x55785f);}[_0x222e('0x6')](_0x4f7173,_0x27da01=()=>!0x0){const _0x2b42a=this['context'][_0x222e('0x1d')][_0x222e('0x13')](_0x5c75f1);if(!this[_0x222e('0x1a')][_0x222e('0x20')](_0x4f7173))throw new _0x519c9e(_0x222e('0x22'),this,{'uiName':_0x4f7173});this[_0x222e('0x12')](_0x4f7173)&&this[_0x222e('0x16')](_0x4f7173),this['activeUIs'][_0x222e('0x17')](_0x4f7173);const _0x191c09=new _0x45efe3(),_0x5890f7=_0x2b42a[_0x222e('0x2b')];_0x242ca8({'source':_0x5890f7,'target':_0x191c09,'filter':_0x27da01}),this[_0x222e('0x26')]['set'](_0x4f7173,{'collection':_0x191c09,'filter':_0x27da01});const _0x11cd83=this['_uis'][_0x222e('0x13')](_0x4f7173);_0x11cd83[_0x222e('0x10')](_0x191c09),this[_0x222e('0x11')](_0x11cd83,_0x222e('0x28'),(_0xda4c12,_0x4f5f75,_0x4e281e,_0x3d9045)=>{_0x3d9045&&_0x2b42a[_0x222e('0x21')](_0x3d9045),_0x4e281e&&_0x2b42a['_addActiveAnnotation'](_0x4e281e);});}['deactivate'](_0x1318c8){if(this['activeUIs'][_0x222e('0x2c')](_0x1318c8),!this[_0x222e('0x1a')][_0x222e('0x20')](_0x1318c8))throw new _0x519c9e(_0x222e('0x22'),this,{'uiName':_0x1318c8});const _0x47484d=this[_0x222e('0x1a')]['get'](_0x1318c8);_0x47484d['detach'](),this[_0x222e('0x7')](_0x47484d),this[_0x222e('0x26')][_0x222e('0x13')](_0x1318c8)[_0x222e('0xc')][_0x222e('0x27')](),this['_uisData']['delete'](_0x1318c8);}['switchTo'](_0x534e78){if(!this[_0x222e('0x1a')][_0x222e('0x20')](_0x534e78))throw new _0x519c9e(_0x222e('0x22'),this,{'uiName':_0x534e78});const _0x47a29c=this[_0x222e('0xf')]['plugins']['get'](_0x5c75f1),_0x47d1e4=Array['from'](_0x47a29c[_0x222e('0x1b')])[0x0]||null;this[_0x222e('0x15')](),this['activate'](_0x534e78);const _0x39f707=this[_0x222e('0x1a')][_0x222e('0x13')](_0x534e78);_0x39f707['setActiveAnnotation'](_0x47d1e4),_0x39f707[_0x222e('0x5')]&&_0x47d1e4&&_0x39f707[_0x222e('0x5')]([_0x47d1e4]);}[_0x222e('0x15')](){for(const _0x39acd6 of this[_0x222e('0x3')])this[_0x222e('0x16')](_0x39acd6);}[_0x222e('0x18')](_0x37f437,_0x15cf1f){if(this[_0x222e('0x1a')][_0x222e('0x20')](_0x37f437))throw new _0x519c9e(_0x222e('0x23'));if(_0x222e('0x8')!=typeof _0x15cf1f[_0x222e('0x10')]||'function'!=typeof _0x15cf1f[_0x222e('0x1c')]||_0x222e('0x8')!=typeof _0x15cf1f[_0x222e('0x1e')])throw new _0x519c9e('annotationsuis-register-invalid-interface',null);this[_0x222e('0x1a')][_0x222e('0x1f')](_0x37f437,_0x15cf1f);}[_0x222e('0xb')](){const _0x49baaa=this[_0x222e('0xf')]['plugins']['get'](_0x5c75f1)[_0x222e('0xc')],_0x5a92ae=new Map(),_0x3a505f=Array[_0x222e('0x19')](this[_0x222e('0x3')]);for(const _0x534575 of this[_0x222e('0x3')]){const _0x1d615f=this[_0x222e('0x26')][_0x222e('0x13')](_0x534575)[_0x222e('0xc')];for(const _0x522227 of _0x1d615f)_0x5a92ae[_0x222e('0x1f')](_0x522227,_0x534575);}for(const _0x85fcf6 of _0x49baaa){const _0x30e0f8=_0x5a92ae[_0x222e('0x13')](_0x85fcf6);this[_0x222e('0x4')](_0x85fcf6);const _0x4822e2=_0x3a505f[_0x222e('0xe')](_0x56dbe7=>this[_0x222e('0x26')][_0x222e('0x13')](_0x56dbe7)['filter'](_0x85fcf6));_0x30e0f8!==_0x4822e2&&(_0x30e0f8&&this[_0x222e('0x26')][_0x222e('0x13')](_0x30e0f8)[_0x222e('0xc')][_0x222e('0x29')](_0x85fcf6),_0x4822e2&&this[_0x222e('0x26')]['get'](_0x4822e2)['collection'][_0x222e('0x17')](_0x85fcf6));}}[_0x222e('0x27')](){this[_0x222e('0x15')](),super[_0x222e('0x27')]();}[_0x222e('0x4')](_0x183ea5){const _0x170f4d=[];for(const _0x49a39e of this[_0x222e('0x3')]){(0x0,this[_0x222e('0x26')]['get'](_0x49a39e)['filter'])(_0x183ea5)&&_0x170f4d[_0x222e('0xa')](_0x49a39e);}if(_0x170f4d[_0x222e('0x14')]>0x1)throw new _0x519c9e('annotationsuis-annotation-mismatch',null,{'matchedUIs':_0x170f4d,'annotationType':_0x183ea5[_0x222e('0x2')]});}}