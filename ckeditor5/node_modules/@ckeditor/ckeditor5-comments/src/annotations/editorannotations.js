/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x43ea=['isCollapsed','editorannotations-invalid-source-callback','document','_dataCollectors','change:range','fire','delete','init','registerAnnotation','from','change:isFocused','pluginName','addSourceCollector','collection','sort','_editorAnnotations','requires','editing','annotation','model','blur','uiUpdate','getRanges','plugins','selection','editor','containsRange','isReadOnly','focusTracker','has','getByInnerView','_editorAnnotationsData','function','hasDomSelection','remove','directChange','listenTo','view','range','innerView','push','update','refresh','add','refreshSelectedViews'];(function(_0x4cd92d,_0x43ea9f){const _0x1b6d04=function(_0x7ddee9){while(--_0x7ddee9){_0x4cd92d['push'](_0x4cd92d['shift']());}};_0x1b6d04(++_0x43ea9f);}(_0x43ea,0x1a7));const _0x1b6d=function(_0x4cd92d,_0x43ea9f){_0x4cd92d=_0x4cd92d-0x0;let _0x1b6d04=_0x43ea[_0x4cd92d];return _0x1b6d04;};import{Plugin as _0x12c412}from'ckeditor5/src/core';import{CKEditorError as _0x33b60c}from'ckeditor5/src/utils';import{debounce as _0x312117}from'lodash-es';import _0x2cb62e from'./annotations';export default class k extends _0x12c412{static get[_0x1b6d('0x2b')](){return[_0x2cb62e];}static get[_0x1b6d('0x26')](){return'EditorAnnotations';}constructor(_0x1961dd){super(_0x1961dd),this[_0x1b6d('0x1e')]=new Set(),this[_0x1b6d('0x2a')]=new Set();}[_0x1b6d('0x22')](){const _0x110d48=this[_0x1b6d('0x7')],_0x33d9e8=_0x110d48[_0x1b6d('0x1')][_0x1b6d('0x1d')][_0x1b6d('0x6')],_0x9cfba3=_0x312117(()=>this[_0x1b6d('0x1a')](),0xa);_0x33d9e8['on'](_0x1b6d('0x1f'),(_0x3bce26,_0x12aa5e)=>{_0x12aa5e[_0x1b6d('0x11')]&&(_0x9cfba3['cancel'](),this[_0x1b6d('0x1a')]());}),this[_0x1b6d('0x12')](_0x110d48['editing']['view'][_0x1b6d('0x1d')],_0x1b6d('0x25'),(_0x3e7fc4,_0x3e15ee,_0x25edcd)=>{_0x25edcd&&_0x9cfba3();}),this['listenTo'](_0x110d48['ui'][_0x1b6d('0xa')],_0x1b6d('0x25'),(_0x373bc1,_0x5ba019,_0x47e9e4)=>{_0x47e9e4||_0x110d48[_0x1b6d('0x9')]||this['fire'](_0x1b6d('0x2'),{'isAnnotationTracked':_0x13427b=>this['_editorAnnotationsData'][_0x1b6d('0xb')](_0x13427b[_0x1b6d('0x15')])});}),this[_0x1b6d('0x12')](this[_0x1b6d('0x7')]['ui'],_0x1b6d('0x17'),()=>this[_0x1b6d('0x20')](_0x1b6d('0x3')));}[_0x1b6d('0x23')](_0x3d8cfd){if(this[_0x1b6d('0x2a')][_0x1b6d('0xb')](_0x3d8cfd[_0x1b6d('0x13')]))return;this[_0x1b6d('0x2a')][_0x1b6d('0x19')](_0x3d8cfd['view']),this[_0x1b6d('0x7')]['ui'][_0x1b6d('0xa')][_0x1b6d('0x19')](_0x3d8cfd['view']['element']);const _0x5da015=this[_0x1b6d('0x7')][_0x1b6d('0x5')]['get'](_0x2cb62e);this[_0x1b6d('0x12')](_0x5da015[_0x1b6d('0x28')],_0x1b6d('0x10'),(_0xd83084,_0x538cd7)=>{this[_0x1b6d('0x7')]['ui']['focusTracker']['remove'](_0x538cd7[_0x1b6d('0x13')]['element']),this[_0x1b6d('0x2a')][_0x1b6d('0x21')](_0x538cd7[_0x1b6d('0x13')]);});}[_0x1b6d('0xf')](){return this[_0x1b6d('0x7')][_0x1b6d('0x2c')][_0x1b6d('0x13')][_0x1b6d('0xf')];}[_0x1b6d('0x27')](_0x2d3ac4){if(_0x1b6d('0xe')!=typeof _0x2d3ac4)throw new _0x33b60c(_0x1b6d('0x1c'));this[_0x1b6d('0x1e')]['add'](_0x2d3ac4);}['refreshSelectedViews'](){this['fire'](_0x1b6d('0x18'));}['getOrderedSelectedAnnotations']({activeAnnotation:_0x1afe65,annotations:_0x5df738}){const _0x5d76a4=[],_0x55984e=this[_0x1b6d('0x7')][_0x1b6d('0x1')][_0x1b6d('0x1d')][_0x1b6d('0x6')],_0x25b46b=Array[_0x1b6d('0x24')](_0x55984e[_0x1b6d('0x4')]());for(const [_0x49cf18,_0x1dcb39]of this[_0x1b6d('0xd')]){const _0x3e9c29=_0x19482b(_0x1dcb39),_0x51e08a=_0x5df738[_0x1b6d('0xc')](_0x49cf18);_0x3e9c29&&_0x51e08a&&_0x5d76a4[_0x1b6d('0x16')]({'annotation':_0x51e08a,'range':_0x3e9c29});}function _0x19482b(_0x40965e){for(const _0x45f424 of _0x40965e)for(const _0x32abfd of _0x25b46b)if(_0x45f424[_0x1b6d('0x8')](_0x32abfd,!_0x55984e[_0x1b6d('0x1b')]))return _0x45f424;return null;}return _0x5d76a4[_0x1b6d('0x29')]((_0xcbc8e6,_0x2eb3e7)=>{const _0x5e95a7=_0xcbc8e6[_0x1b6d('0x14')],_0x1c31bb=_0x2eb3e7[_0x1b6d('0x14')];if(!_0x5e95a7['isEqual'](_0x1c31bb)){if(_0x5e95a7[_0x1b6d('0x8')](_0x1c31bb,!0x0))return 0x1;if(_0x1c31bb[_0x1b6d('0x8')](_0x5e95a7,!0x0))return-0x1;}return _0xcbc8e6[_0x1b6d('0x0')]==_0x1afe65?-0x1:_0x2eb3e7[_0x1b6d('0x0')]==_0x1afe65?0x1:0x0;})['map'](_0x3ecae8=>_0x3ecae8[_0x1b6d('0x0')]);}get['_editorAnnotationsData'](){const _0x4860a0=new Map();for(const _0x28fd39 of Array['from'](this[_0x1b6d('0x1e')]))for(const [_0x19fac1,_0x368542]of _0x28fd39())_0x4860a0['set'](_0x19fac1,_0x368542);return _0x4860a0;}}