/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x30db=['_threadToController','ck-body','push','collection','_pendingThreads','length','mainView','collaboration.channelId','findIndex','Annotations','_calculatePosition','get','_createArchiveUIDropdown','find','annotationViews','classList','plugins','isVisible','listenTo','CommentsRepository','focusableElements','focusTracker','buttonView','contains','config','children','extendTemplate','channelId','_handleAnnotationFocusableElements','innerView','add','remove','position','locale','panelView','_visibleAnnotations','set','init','editor','filter','resolvedThreads','resolvedAt','getByInnerView','CommentsArchiveUI','change:isOpen','view','commentsArchive','commentsArchiveView'];(function(_0x1639ec,_0x30db15){const _0x1ce3db=function(_0x2790ef){while(--_0x2790ef){_0x1639ec['push'](_0x1639ec['shift']());}};_0x1ce3db(++_0x30db15);}(_0x30db,0xc1));const _0x1ce3=function(_0x1639ec,_0x30db15){_0x1639ec=_0x1639ec-0x0;let _0x1ce3db=_0x30db[_0x1639ec];return _0x1ce3db;};import'../../theme/commentsarchive.css';import{Plugin as _0x41b119}from'ckeditor5/src/core';import{createDropdown as _0x539c44,ViewCollection as _0x4a723a}from'ckeditor5/src/ui';import _0x560133 from'../../theme/icons/comments-archive.svg';import{getTranslation as _0x445600}from'../utils/common-translations';import _0x5f03d6 from'./ui/view/commentsarchiveview';import _0x2089d8 from'./commentsarchive';export default class a extends _0x41b119{static get['pluginName'](){return _0x1ce3('0x2a');}static get['requires'](){return[_0x2089d8];}constructor(_0x10b63b){super(_0x10b63b),this['annotationViews']=new _0x4a723a(),this[_0x1ce3('0x3')]=[];}[_0x1ce3('0x24')](){this[_0x1ce3('0x25')]['ui']['componentFactory']['add'](_0x1ce3('0x2d'),()=>this[_0x1ce3('0xb')]());const _0x2bf972=this[_0x1ce3('0x25')]['plugins'][_0x1ce3('0xa')](_0x2089d8),_0x3217ff=this[_0x1ce3('0x25')][_0x1ce3('0xf')][_0x1ce3('0xa')]('Annotations'),_0x298437=this[_0x1ce3('0x25')][_0x1ce3('0xf')]['get'](_0x1ce3('0x12'));this[_0x1ce3('0x11')](_0x2bf972[_0x1ce3('0x27')],_0x1ce3('0x1d'),(_0x5a7c18,_0x930dd2)=>{const _0x20fa02=this[_0x1ce3('0x25')][_0x1ce3('0x17')][_0x1ce3('0xa')](_0x1ce3('0x6'));if(!_0x20fa02||_0x930dd2[_0x1ce3('0x1a')]===_0x20fa02){const _0x5943a8=this[_0x1ce3('0x9')](_0x930dd2[_0x1ce3('0x28')]),_0x1be2e4=_0x298437[_0x1ce3('0x2f')][_0x1ce3('0xa')](_0x930dd2);if(!_0x1be2e4)return void this[_0x1ce3('0x3')][_0x1ce3('0x1')]({'thread':_0x930dd2,'position':_0x5943a8});const _0x2efc49=_0x3217ff[_0x1ce3('0x29')](_0x1be2e4['view']);_0x2efc49[_0x1ce3('0x10')]&&_0x3217ff[_0x1ce3('0x22')][_0x1ce3('0x1e')](_0x2efc49),this['annotationViews']['add'](_0x2efc49[_0x1ce3('0x2c')],_0x5943a8);}}),this[_0x1ce3('0x11')](_0x3217ff[_0x1ce3('0x2')],_0x1ce3('0x1d'),(_0x28e724,_0x4db21c)=>{const _0x2c4ce3=this['_pendingThreads'][_0x1ce3('0xc')](({thread:_0x5eb3e7})=>{const _0x2bfe21=_0x298437['_threadToController'][_0x1ce3('0xa')](_0x5eb3e7);return _0x2bfe21&&_0x4db21c[_0x1ce3('0x1c')]===_0x2bfe21[_0x1ce3('0x2c')];});_0x2c4ce3&&(this[_0x1ce3('0xd')][_0x1ce3('0x1d')](_0x4db21c['view'],_0x2c4ce3[_0x1ce3('0x1f')]),this[_0x1ce3('0x3')]['splice'](this[_0x1ce3('0x3')]['indexOf'](_0x2c4ce3),0x1));}),this[_0x1ce3('0x11')](_0x2bf972[_0x1ce3('0x27')],_0x1ce3('0x1e'),(_0x4a419b,_0x31aa3f)=>{const _0x443e65=this[_0x1ce3('0x25')][_0x1ce3('0x17')][_0x1ce3('0xa')](_0x1ce3('0x6'));if(!_0x443e65||_0x31aa3f['channelId']===_0x443e65){const _0x5a26f5=_0x298437[_0x1ce3('0x2f')][_0x1ce3('0xa')](_0x31aa3f),_0x40c45e=_0x3217ff['getByInnerView'](_0x5a26f5[_0x1ce3('0x2c')]);this['annotationViews'][_0x1ce3('0x1e')](_0x40c45e[_0x1ce3('0x2c')]),this['stopListening'](_0x40c45e['focusableElements']);}});}[_0x1ce3('0x1b')](_0x454349,_0x41e0f3){for(const _0x1a0998 of _0x41e0f3[_0x1ce3('0x13')])_0x1a0998[_0x1ce3('0xe')][_0x1ce3('0x16')](_0x1ce3('0x0'))&&_0x454349[_0x1ce3('0x14')][_0x1ce3('0x1d')](_0x1a0998);this[_0x1ce3('0x11')](_0x41e0f3[_0x1ce3('0x13')],'add',(_0x59e4c6,_0x1bafbe)=>{_0x1bafbe[_0x1ce3('0xe')]['contains'](_0x1ce3('0x0'))&&_0x454349[_0x1ce3('0x14')][_0x1ce3('0x1d')](_0x1bafbe);}),this[_0x1ce3('0x11')](_0x41e0f3['focusableElements'],_0x1ce3('0x1e'),(_0x470138,_0xee05b2)=>{_0xee05b2[_0x1ce3('0xe')][_0x1ce3('0x16')](_0x1ce3('0x0'))&&_0x454349[_0x1ce3('0x14')][_0x1ce3('0x1e')](_0xee05b2);});}[_0x1ce3('0x9')](_0x12f446){const _0x1c3264=this[_0x1ce3('0x25')][_0x1ce3('0x17')][_0x1ce3('0xa')](_0x1ce3('0x6')),_0x3a7ae2=[...this[_0x1ce3('0x25')][_0x1ce3('0xf')][_0x1ce3('0xa')](_0x2089d8)['resolvedThreads']][_0x1ce3('0x26')](_0x1639c5=>_0x1639c5[_0x1ce3('0x1a')]!==_0x1c3264)[_0x1ce3('0x7')](_0x33f0d2=>_0x33f0d2[_0x1ce3('0x28')]<_0x12f446);return _0x3a7ae2>-0x1?_0x3a7ae2:this['annotationViews'][_0x1ce3('0x4')];}[_0x1ce3('0xb')](){const _0xbc93e9=this[_0x1ce3('0x25')],_0xd69227=this[_0x1ce3('0x25')][_0x1ce3('0xf')]['get'](_0x1ce3('0x8')),_0x206a0f=_0x539c44(_0xbc93e9[_0x1ce3('0x20')]);_0x206a0f[_0x1ce3('0x15')][_0x1ce3('0x23')]({'icon':_0x560133,'label':_0x445600(_0xbc93e9[_0x1ce3('0x20')],'COMMENTS_ARCHIVE'),'tooltip':!0x0}),_0x206a0f[_0x1ce3('0x21')][_0x1ce3('0x19')]({'attributes':{'class':'ck-comments-archive-dropdown'}}),_0x206a0f['on'](_0x1ce3('0x2b'),(_0x3041a2,_0x19aada,_0x56afc3)=>{this[_0x1ce3('0x2e')]||(this['commentsArchiveView']=new _0x5f03d6(_0xbc93e9['locale'],this[_0x1ce3('0xd')])),_0x56afc3?_0x206a0f[_0x1ce3('0x21')][_0x1ce3('0x18')][_0x1ce3('0x1d')](this[_0x1ce3('0x2e')]):_0x206a0f[_0x1ce3('0x21')]['children']['remove'](this['commentsArchiveView']);});for(const _0x385db7 of this[_0x1ce3('0xd')]){const _0x3c3203=_0xd69227['getByInnerView'](_0x385db7[_0x1ce3('0x5')]);this[_0x1ce3('0x1b')](_0x206a0f,_0x3c3203);}return _0x206a0f[_0x1ce3('0x11')](this['annotationViews'],_0x1ce3('0x1d'),(_0x469701,_0x201fc3)=>{const _0x3155bf=_0xd69227['getByInnerView'](_0x201fc3[_0x1ce3('0x5')]);this['_handleAnnotationFocusableElements'](_0x206a0f,_0x3155bf);}),_0x206a0f['listenTo'](this['annotationViews'],_0x1ce3('0x1e'),(_0x71c110,_0x314f97)=>{const _0xc9734f=_0xd69227[_0x1ce3('0x29')](_0x314f97['mainView']);for(const _0x3ca9dd of _0xc9734f['focusableElements'])_0x3ca9dd['classList']['contains'](_0x1ce3('0x0'))&&_0x206a0f[_0x1ce3('0x14')][_0x1ce3('0x1e')](_0x3ca9dd);}),_0x206a0f;}}