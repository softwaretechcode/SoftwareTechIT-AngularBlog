/*
 *             Copyright (c) 2003-2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0xa192=['length','visibleViews','resolvedBy','maxCommentCharsWhenCollapsed','commentViews','change:isEditMode','_handleNewCommentModel','isActive','updateComment','change:isResolved','_findOptimalIndex','from','focus','setTemplate','resolvedAt','_collapsedCommentsView','collapse','Marked\x20as\x20resolved','equal','destroy','ck-thread__comments','_calculatePosition','createCollection','refreshVisibleViews','maxThreadTotalWeight','add','_handleInfoComment','_updateHasDirtyComment','element','hasDirtyComment','_handleRemoveCommentModel','count','_model','locale','some','remove','expand','weight','listenTo','comments','authoredAt','editorReady','_config','editorConfig','formatDateTime','delete','resolvedCommentView','_rearrangeCollapse','_shouldCollapse','_rearrangeExpand','delegate','editorDestroyed','bind','CommentView','stopListening','get','set','isEditMode'];(function(_0x5c3fe1,_0xa1923c){const _0x2e0d3c=function(_0x45922d){while(--_0x45922d){_0x5c3fe1['push'](_0x5c3fe1['shift']());}};_0x2e0d3c(++_0xa1923c);}(_0xa192,0x1e7));const _0x2e0d=function(_0x5c3fe1,_0xa1923c){_0x5c3fe1=_0x5c3fe1-0x0;let _0x2e0d3c=_0xa192[_0x5c3fe1];return _0x2e0d3c;};import{View as _0x5c5e36}from'ckeditor5/src/ui';import{diff as _0x4141e9,Collection as _0x5c43ae}from'ckeditor5/src/utils';import{getTranslation as _0x5054b5}from'../../../utils/common-translations';import _0xe4c0a9 from'./collapsedcommentsview';export default class wt extends _0x5c5e36{constructor(_0x56966c,_0x46722d,_0x45d7d0){super(_0x56966c),this['set']('hasDirtyComment',!0x1),this['set']('length',_0x46722d[_0x2e0d('0x10')]['length']),this[_0x2e0d('0x21')](_0x2e0d('0x2a'),!0x1),this['_model']=_0x46722d,this[_0x2e0d('0x13')]=_0x45d7d0,this[_0x2e0d('0x27')]=this[_0x2e0d('0x39')](),this[_0x2e0d('0x24')]=this[_0x2e0d('0x39')](),this[_0x2e0d('0x17')]=null,this[_0x2e0d('0x32')]=new _0xe4c0a9(_0x56966c),this[_0x2e0d('0x32')][_0x2e0d('0x1d')](_0x2e0d('0x8'))['to'](this,_0x2e0d('0x23'),_0x17c8fe=>_0x17c8fe-this['_config']['maxCommentsWhenCollapsed']);for(const _0x2658da of _0x46722d[_0x2e0d('0x10')])this[_0x2e0d('0x29')](_0x2658da);this['_handleInfoComment'](),this['listenTo'](_0x46722d[_0x2e0d('0x10')],_0x2e0d('0x2'),(_0xf4ecb9,_0x2d33b4)=>{const _0x41b754=this[_0x2e0d('0x38')](_0x2d33b4);this['length']++,this[_0x2e0d('0x29')](_0x2d33b4,_0x41b754),this['refreshVisibleViews']();}),this[_0x2e0d('0xf')](_0x46722d[_0x2e0d('0x10')],_0x2e0d('0xc'),(_0x3b72ec,_0x45fed9)=>{this[_0x2e0d('0x23')]--,this[_0x2e0d('0x7')](_0x45fed9),this['refreshVisibleViews']();}),this[_0x2e0d('0xf')](_0x46722d,'commentUpdated',()=>this[_0x2e0d('0x0')]()),this[_0x2e0d('0xf')](_0x46722d,_0x2e0d('0x2c'),()=>this[_0x2e0d('0x3')]()),this['on']('change:isActive',()=>this[_0x2e0d('0x0')]()),this['on']('change:hasDirtyComment',()=>this['refreshVisibleViews']()),this[_0x2e0d('0x30')]({'tag':'ul','attributes':{'class':[_0x2e0d('0x37')]},'children':this[_0x2e0d('0x24')]});}get[_0x2e0d('0x19')](){return this['_model'][_0x2e0d('0xe')]>this[_0x2e0d('0x13')][_0x2e0d('0x1')]&&!this[_0x2e0d('0x2a')]&&!this['hasDirtyComment'];}['render'](){super['render'](),this[_0x2e0d('0x0')]();}[_0x2e0d('0x2f')](){this[_0x2e0d('0x5')][_0x2e0d('0x2f')]();}[_0x2e0d('0x36')](){this[_0x2e0d('0x32')][_0x2e0d('0x36')]();for(const _0x66935f of this[_0x2e0d('0x27')])_0x66935f[_0x2e0d('0x36')]();super[_0x2e0d('0x36')]();}['refreshVisibleViews'](){this[_0x2e0d('0x19')]?this['_rearrangeCollapse']():this[_0x2e0d('0x1a')]();}['_handleNewCommentModel'](_0x25d86a,_0x3c65f7){const _0x14f6e5=new this[(_0x2e0d('0x13'))][(_0x2e0d('0x1e'))](this['locale'],_0x25d86a,{'maxCommentCharsWhenCollapsed':this[_0x2e0d('0x13')][_0x2e0d('0x26')],'formatDateTime':this[_0x2e0d('0x13')][_0x2e0d('0x15')],'editorConfig':this['_config'][_0x2e0d('0x14')]});_0x14f6e5['viewUid']=_0x25d86a['id'],_0x14f6e5[_0x2e0d('0x1b')]('removeComment')['to'](this),_0x14f6e5[_0x2e0d('0x1b')](_0x2e0d('0x2b'))['to'](this),_0x14f6e5['delegate']('resolveCommentThread')['to'](this),_0x14f6e5['delegate'](_0x2e0d('0x12'))['to'](this),_0x14f6e5[_0x2e0d('0x1b')](_0x2e0d('0x1c'))['to'](this),this['listenTo'](_0x14f6e5,_0x2e0d('0x28'),()=>this[_0x2e0d('0x4')]()),this[_0x2e0d('0x27')][_0x2e0d('0x2')](_0x14f6e5,_0x3c65f7);}[_0x2e0d('0x38')](_0x3024d0){const _0x336084=this[_0x2e0d('0x9')][_0x2e0d('0x2d')](_0x3024d0);return this[_0x2e0d('0x17')]?this['resolvedCommentView'][_0x2e0d('0x11')]>_0x3024d0[_0x2e0d('0x11')]?_0x336084-0x1:_0x336084:_0x336084-0x1;}[_0x2e0d('0x3')](){if(this[_0x2e0d('0x9')][_0x2e0d('0x25')]&&this[_0x2e0d('0x9')][_0x2e0d('0x31')]){const _0xab3f2c={'id':'resolved','author':this['_model'][_0x2e0d('0x25')],'authoredAt':this[_0x2e0d('0x9')]['resolvedAt'],'content':_0x5054b5(this[_0x2e0d('0xa')],_0x2e0d('0x34')),'attributes':{}};this[_0x2e0d('0x17')]=new this['_config'][(_0x2e0d('0x1e'))](this[_0x2e0d('0xa')],_0xab3f2c,{'maxCommentCharsWhenCollapsed':this[_0x2e0d('0x13')][_0x2e0d('0x26')],'formatDateTime':this[_0x2e0d('0x13')][_0x2e0d('0x15')],'editorConfig':this['_config'][_0x2e0d('0x14')],'isSystemComment':!0x0}),this[_0x2e0d('0x27')]['add'](this[_0x2e0d('0x17')],this[_0x2e0d('0x9')][_0x2e0d('0x2d')](_0xab3f2c));}else this[_0x2e0d('0x17')]&&(this['commentViews']['remove'](this[_0x2e0d('0x17')]),this[_0x2e0d('0x17')][_0x2e0d('0x36')](),this[_0x2e0d('0x17')]=null);this[_0x2e0d('0x0')]();}['_handleRemoveCommentModel'](_0x20fa11){const _0x4c962f=this[_0x2e0d('0x27')][_0x2e0d('0xc')](_0x20fa11['id']);this[_0x2e0d('0x1f')](_0x4c962f),_0x4c962f[_0x2e0d('0x22')]&&this[_0x2e0d('0x4')](),_0x4c962f[_0x2e0d('0x36')]();}[_0x2e0d('0x4')](){this[_0x2e0d('0x6')]=Array['from'](this[_0x2e0d('0x27')])[_0x2e0d('0xb')](_0x263845=>_0x263845[_0x2e0d('0x22')]);}[_0x2e0d('0x18')](){const _0x492490=function(_0x20ba76){const _0x2628a3=new _0x5c43ae();for(const _0x35ab37 of _0x20ba76)_0x2628a3[_0x2e0d('0x2')](_0x35ab37);return _0x2628a3;}(this[_0x2e0d('0x27')]),_0x3ea828=this['_collapsedCommentsView']['count'];for(let _0x19e358=0x1;_0x19e358<=_0x3ea828;_0x19e358++)_0x492490['remove'](0x1);for(const _0x28402c of _0x492490)_0x28402c[_0x2e0d('0x33')]();_0x3ea828>0x0&&_0x492490[_0x2e0d('0x2')](this[_0x2e0d('0x32')],0x1),ss(_0x4141e9(Array[_0x2e0d('0x2e')](this['visibleViews']),Array[_0x2e0d('0x2e')](_0x492490)),this[_0x2e0d('0x24')],_0x492490);}[_0x2e0d('0x1a')](){ss(_0x4141e9(Array[_0x2e0d('0x2e')](this[_0x2e0d('0x24')]),Array[_0x2e0d('0x2e')](this['commentViews'])),this[_0x2e0d('0x24')],this[_0x2e0d('0x27')]);for(const _0x3879e0 of this[_0x2e0d('0x24')])_0x3879e0[_0x2e0d('0xd')]();}}function ss(_0x21bc31,_0xe3a488,_0x4e648a){let _0x2bf598=0x0;for(const _0x1f13dd of _0x21bc31)switch(_0x1f13dd){case'insert':_0xe3a488['add'](_0x4e648a[_0x2e0d('0x20')](_0x2bf598),_0x2bf598),_0x2bf598++;break;case _0x2e0d('0x16'):_0xe3a488[_0x2e0d('0xc')](_0x2bf598);break;case _0x2e0d('0x35'):_0x2bf598++;}}